# 乐企开票能力（基础版）说明文档

V3.005

修改说明  

<table><tr><td>版本</td><td>章节编号</td><td>修订内容描述</td><td>生效日期</td></tr><tr><td>V2.006</td><td>第三章/1.2.1</td><td>增加数电发票段禁止跨年使用校验。</td><td>2022-12-28</td></tr><tr><td>V2.006</td><td>第四章/12</td><td>发票上传接口中购买方纳税人识别号填写增加校验规则</td><td>2022-12-28</td></tr><tr><td>V2.006</td><td>第四章</td><td>按照新版文档格式调整接口框架名称</td><td>2022-12-29</td></tr><tr><td>V2.006</td><td>第四章</td><td>发票上传接口中“服务器地址”和“mac地址”字段说明增加“需自行采集开票申请设备”。</td><td>2022-12-29</td></tr><tr><td>V2.006</td><td>第四章</td><td>查询发票额度接口说明中增加查询发票额度次数限制说明。</td><td>2022-12-29</td></tr><tr><td>V2.006</td><td>第三章和第四章</td><td>将“全电发票”“新电票”改为“数电发票”。</td><td>2023-01-10</td></tr><tr><td>V2.006</td><td>第四章</td><td>发票上传接口-接口说明中增加“每次上传最大票量为100张数电发票”内容。</td><td>2023-01-10</td></tr><tr><td>V2.006</td><td>第四章</td><td>发票上传接口中“平台编号”字段说明中增加“接入单位ID”。</td><td>2023-01-10</td></tr><tr><td>V2.006</td><td>全部</td><td>“接入单位”修改为“直连单位”。</td><td>2023-02-16</td></tr><tr><td>V2.006</td><td>第三章</td><td>2.2.4.3增加“平台编号”字段值必须为直连单位ID校验。</td><td>2023-04-19</td></tr><tr><td>V2.006</td><td>第三、四章</td><td>第三章“1.2.6获取可用税收分类编码”增加增值税特殊开票税率实现内容。“4.2.4上传数电红字确认单确认信息”增加红字确认单撤销内容。第四章16数电红字确认单确认接口中“确认类型”增加“C:撤销”状态。11查询数电红字确认单明细信息、13查询数电红字确认单列表信息接口返回参数增加“录入日期”字段。</td><td>2023-05-27</td></tr><tr><td>V2.006</td><td>第三章</td><td>增加“开票汇总确认”业务场景</td><td>2023-05-30</td></tr><tr><td>V2.006</td><td>第四章</td><td>增加“上传发票汇总确认信息”和“查询发票汇总确认信息”两个接口</td><td>2023-05-30</td></tr><tr><td>V2.006</td><td>第三章</td><td>2.2.4.1调整“单价”、“数量”的校验逻辑;3.2.3.1调整“单价”、“数量”的校验逻辑;5.2.4.1调整“单价”、“数量”的校验逻辑;6调整发票汇总确认时间。</td><td>2023-07-07</td></tr><tr><td>V2.006</td><td>第四章</td><td>12.数字化电子发票上传接口,调整“单位”、“单价”、“数量”填写说明;15.数字化电子红字确认单申请接口,调整“单位”、“单价”、“数量”填写说明;11.查询数字化电子红字确认单明细信息接口,调整“单位”、“单价”、“数量”说明;17.上传发票汇总确认信息调整发票汇总确认时间。</td><td>2023-07-07</td></tr><tr><td>V2.006</td><td>全部</td><td>阅读指引增加“以下简称数电票”描述。“授信额度”改为“发票额度”,“授信制”改为“赋额制”;“能力介绍”的应用案例中补充说明开票流程,举例说明本地使用数电票号码段设定百分比阈值作用;“主要政策依据”部分,增加各试点省局关于乐企公告的链接地址;“名词解释”部分增加“赋额制”等7个名词解释;扩展阅读中举例说明当月发票总额度、剩余发票额度、按需开票相关内容;第三章数电票开具前置全流程图修改为蓝票前置流程图和红票前置流程图;第三章删除时序图及各小节的流程图;各场景增加对应接口描述。第三章合并“数电红字确认单申请”、“数电红字确认单确认”、“数电红票开具”章节;“3.1.2.2本地判断蓝字发票是否可红冲”增加蓝票信息获取判断描述。第四章“接口列表”章节接口清单的表格中,增加各接口的服务编码,表格后增加接口调用说明,删除各接口中的“请求方式”章节。“获取数电票批量预赋码信息”、“下载/退回发票额度”接口请求参数增加“业务流水号”;“查询发票额度”增加按需开票有关描述;删除“批量发票下载”及“发票状态信息查询”接口。第四章“9查询数电红字确认单明细信息”、“11查询数电红字确认单列表信息”接口说明增加红字确认单状态描述。</td><td>2023-07-12</td></tr><tr><td></td><td></td><td></td><td></td></tr><tr><td>V2.006</td><td>第三章</td><td>3.1.2.3.3业务逻辑校验增加红冲税控蓝票填写规则。</td><td>2023-07-19</td></tr><tr><td>V2.006</td><td>第三、四章</td><td>第三章3.3.2.4.1合规性校验调整对应蓝字发票号码说明；第四章10.数电票上传接口修改对应蓝字发票号码说明。</td><td>2023-07-19</td></tr><tr><td>V2.006</td><td>第三章</td><td>2.2.4.3增加农产品发票认定规则。</td><td>2023-07-31</td></tr><tr><td>V2.006</td><td>第三、四章</td><td>第三章3.1.2.3.3、3.3.2.4.2增加农产品发票相关填写规则；第四章9.查询红字确认单明细信息、11.查询数电红字确认单列表信息、13.红字确认单申请中“蓝字发票特定要素类型代码”说明添加“20：农产品”。</td><td>2023-07-31</td></tr><tr><td>V2.006</td><td>第三、四章</td><td>第三章2.2.4.1,3.3.2.4.1合规性校验增加是否展示销售方银行账号标签、是否展示购买方银行账号标签、收款人姓名、复核人姓名字段。第四章10.数电票上传接口相应增加字段。</td><td>2023-07-31</td></tr><tr><td>V2.006</td><td>第三、四章</td><td>第三章2.2.4.3业务逻辑校验增加发票明细条数限制；第四章12.查询数电票上传结果增加查询时间限制。</td><td>2023-08-23</td></tr><tr><td>V2.006</td><td>第三章</td><td>三、开发指引：增加Unicode编码使用限制</td><td>2023-11-02</td></tr><tr><td>V2.006</td><td>第三章</td><td>2.2.4.3业务逻辑校验增加购销方税号校验规则。</td><td>2023-11-03</td></tr><tr><td>V2.006</td><td>第三章</td><td>2.2.4.3业务逻辑校验增加非汇总项编码校验。</td><td>2023-11-03</td></tr><tr><td>V2.006</td><td>第三章</td><td>2.2.4.3业务逻辑校验、3.3.2.4.2数据校验调整农产品专票认定规则。</td><td>2023-11-09</td></tr><tr><td>V3.000</td><td>第三章</td><td>2.2.4.2数据校验优化折扣行校验规则。</td><td>2023-11-20</td></tr><tr><td>V3.000</td><td>第三章</td><td>16.查询发票汇总确认信息返回参数增加销售方纳税人识别号</td><td>2023-11-25</td></tr><tr><td>V3.000</td><td>第三、四章</td><td>第三章2.2.4.1合规性校验、2.2.4.2数据校验、2.2.4.3业务逻辑校验、3.1.2.3.3业务逻辑校验、3.3.2.4.1合规性校验、3.3.2.4.2数据校验增加差额征税发票相关校验。第四章9.查询数电红字确认单明细信息返回参数增加差额征税类型代码、扣除额、优惠政策标识字段,10.数电票上传接口增加差额扣除清单,新增17.查询差额征收编码接口。</td><td>2023-12-21</td></tr><tr><td>V3.000</td><td>第三章</td><td>2.2.4.3业务逻辑校验、3.3.2.4.2数据校验增加发票上传时间规则说明。</td><td>2023-12-27</td></tr><tr><td>V3.001</td><td>第三、四章</td><td>第三章1.2.6获取可用税收分类编码、第四章8.1接口说明减按优惠政策标识描述调整。</td><td>2024-01-26</td></tr><tr><td>V3.002</td><td>第三章</td><td>2.2.4.3业务校验规则调整电信行业开具汇总项编码规则。</td><td>2024-03-11</td></tr><tr><td>V3.002</td><td>第三、四章</td><td>第三章1.2.6获取可用税收分类编码、第四章8.1接口说明调整优惠政策混开规则。</td><td>2024-03-14</td></tr><tr><td>V3.003</td><td>第三章</td><td>3.1.2.3.3业务逻辑校验调整红字确认单金额、销售折让校验逻辑。</td><td>2024-03-21</td></tr><tr><td>V3.003</td><td>第三、四章</td><td>第三章2.2.4.1、3.3.2.4.1合规性校验特定要素字段调整；第四章10.数电票上传接口特定要素调整。</td><td>2024-03-21</td></tr><tr><td>V3.004</td><td>第三章</td><td>2.2.4.3业务逻辑校验删除购销方税号校验规则。</td><td>2024-04-19</td></tr><tr><td>V3.004</td><td>第三、四章</td><td>第三章1.2.6获取可用税收分类编码、第四章8.1接口调整不征税优惠政策混开规则表述。</td><td>2024-04-19</td></tr><tr><td>V3.005</td><td>第三、四章</td><td>第三章1.2.6获取可用税收分类编码、第四章8.1接口调整不征税优惠混开规则。</td><td>2024-04-25</td></tr></table>

# 一、阅读指引

为了满足纳税人多场景、规模化、合规化、自动化的全面数字化的电子发票（以下简称“数电票”）开具需求，乐企数字开放平台提供数电票开具能力，并通过本能力说明文档明确了数电票开具相关业务规则和数据接口。

本能力适用于销售货物或提供服务开具增值税发票的纳税人订阅。

本能力说明文档分为阅读指引、能力介绍、开发指引、接口列表四个章节，其中阅读指引及能力介绍章节适合纳税人管理人员及财务人员阅读；开发指引及接口列表章节适合纳税人技术人员阅读。

# 二、能力介绍

# （一）能力简介

纳税人销售货物或提供服务时，可以通过本能力开具数电票。

纳税人可将本能力中的各类规则和接口嵌入本单位信息化系统中（如：销售、收款、结算等），实现数电票开具流程和商业行为的融合，有效提升数电票开具效率。

纳税人可以同时使用本能力、电子发票服务平台开具数电票（税务机关另有规定除外）。

# （二）应用案例

# 1、某电子商务平台订单完成自动开票

某电子商务平台将数电票开具能力嵌入网上平台销售系统，当消费者确认收货，交易正式完成时，网上平台销售系统通过乐企嵌入的数电票开具规则和接口，组合商品、订单、支付、物流、前置开票能力获取的发票要素等信息自动生成数电票电子文件（包括XML、OFD、PDF等格式），企业可自行选择先将开具发票的数据上传给税务局端再进行数电票电子文件交付，或是先进行数电票电子文件交付，再进行发票数据的上传，同时企业可根据自身开票情况，对本地已下载未使用的发票额度设置百分比阈值，当已下载未使用的发票额度小于设置的阈值时，自动触发下载发票额度操作，例如企业当月发票总额度为1000万，设置的百分比阈值为20%（该比例可由企业自行选择设置），则企业本地已下载未使用的发票额度的阈值为200万，当企业本地已下载未使用的发票额度小于100万时，可自动触发下载发票额度操作，避免出现因本地未使用的发票额度不足导致开票失败的情形。

# 2、某制造业企业资金结算自动开票

某制造业企业将数电票开具能力嵌入销售结算系统，当销售方确认收入、产生结算单时，销售结算系统通过乐企嵌入的数电票开具规则和接口，组合商品、结算、前置开票能力获取的发票要素等信息自动生成数电票，完成交付并推送至财务系统，同时进行账务处理。

# 主要政策依据

国家税务总局各省（自治区、直辖市、计划单列市）税务局关于推行全面数字化电子发票的相关公告。

上海市关于乐企自用直连服务的规范指引链接地址：

http://shanghai.chinatax.gov.cn/xxgk/tzgg/202304/t466805.html

河南省关于乐企自用直连服务的规范指引链接地址：

https://henan.chinatax.gov.cn/henanchinatax/xxgk/tzgg/2023053116212842318/index.html

辽宁省关于乐企自用直连服务的规范指引链接地址：

http://liaoning.chinatax.gov.cn/art/2023/5/31/art_6586_104922.html

江西省关于乐企自用直连服务的规范指引链接地址：

https://jiangxi.chinatax.gov.cn/art/2023/5/31/art_40229_1553482.html

广西关于乐企自用直连服务的规范指引链接地址：

http://guangxi.chinatax.gov.cn/xxgk/tzgg/202306/t20230601_388057.html

江苏省关于乐企自用直连服务的规范指引链接地址：

https://jiangsu.chinatax.gov.cn/art/2023/5/31/art_8349_423242.html

浙江省关于乐企自用直连服务的规范指引链接地址：

http://zhejiang.chinatax.gov.cn/art/2023/6/1/art_22104_590203.html

宁波市关于乐企自用直连服务的规范指引链接地址：

http://ningbo.chinatax.gov.cn/art/2023/6/2/art_1910_255263.html

大连市关于乐企自用直连服务的规范指引链接地址：

http://dalian.chinatax.gov.cn/art/2023/6/2/art_1715_141205.html

重庆市关于乐企自用直连服务的规范指引链接地址：

http://chongqing.chinatax.gov.cn/cqtax/xxgk/tzgg/202306/t20230605_352689.html

吉林省关于乐企自用直连服务的规范指引链接地址：

http://jin.chinatax.gov.cn/art/2023/6/1/art_404_644347.html

天津市关于乐企自用直连服务的规范指引链接地址：

http://tianjin.chinatax.gov.cn/1120000000/0100/010003/20230531113703193.shtml

深圳关于乐企自用直连服务的规范指引链接地址：

https://shenzhen.chinatax.gov.cn/sztax/xxgk/tzgg/202305/99455b27c3744ac8ba20766caa9b2045.shtml

四川省关于乐企自用直连服务的规范指引链接地址：

https://file.sichuan.chinatax.gov.cn/softdownload/manual/cljzy/%E5%9B%BD%E5%AE%B6%E7%A8%8 E%E5%8A%A1%E6%80%BB%E5%B1%80%E5%9B%9B%E5%B7%9D%E7%9C%81%E7%A8%8E%E5%8A %A1%E5%B1%80%E5%85%B3%E4%BA%E4%B9%90%E4%BC%81%E8%87%AA%E7%94%A8%E7% 9B%B4%E8%BF%9E%E6%9C%8D%E5%8A%A1%E7%9A%84%E8%A7%84%E8%8C%83%E6%8C%87%E 5%BC%95.pdf

广东省关于乐企自用直连服务的规范指引链接地址：

https://guangdong.chinatax.gov.cn/gdzdgkjbml/mltzgg/2023-03/08/content_84d3b19d584b42f886ab4b1517029512.shtml

厦门市关于乐企自用直连服务的规范指引链接地址：

http://xiamen.chinatax.gov.cn/xmswcms/content/S50697.html

内蒙古自治区关于乐企自用直连服务的规范指引链接地址：

https://neimenggu.chinatax.gov.cn/xxgk/tzgg/202302/t20230222_774795.html

# （四）名词解释

直连单位：指的是申请直连乐企数字开放平台且税务机关审核通过的纳税人。

使用单位:指的是被直连单位邀请直连乐企数字开放平台且税务机关审核通过的纳税人。

开具前置：指的是纳税人在开具发票前所获取的关于开票相关信息的能力。

赋额制：指的是税务机关按照纳税人“信用”情况，结合生产经营、开票和申报行为，自动为纳税人赋予发票总额度并动态调整，实现“以系统赋额为主，人工调整为辅”的赋额制管理。

首次初始赋额：指纳税人（包括新办纳税人和存量纳税人）首次申请数电票时，系统第一次赋予纳税人发票额度的行为。首次初始赋额对每个纳税人全生命周期中仅有一次。

首次初始发票额度：指纳税人（包括新办纳税人和存量纳税人）首次申请数电票时，系统第一次赋予纳税人的具体发票额度。该额度根据试点纳税人的赋额类别确定。

月初赋额：指首次初始赋额后，系统每月1日依据特定规则，赋予纳税人当月初始发票额度的行为。

月初发票额度：指首次初始赋额后，系统每月1日依据特定规则，赋予纳税人的当月初始发票的额度。月初发票额度是按照赋额类别的变化情况，在上月月初发票额度、系统定期调增额度、系统定期调减额度、赋额类别默认发票额度和人工调整额度中，按优先规则确定。

当月发票总额度：是指一个自然月内，纳税人发票可开具总金额（不含增值税）的上限额度。

剩余可用发票额度：是指在一个自然月内，纳税人当月发票总额度扣除当月已使用额度，剩余的可用发票额度。

预赋码信息：指的是纳税人在开具发票前所需获取的数字化电子发票号码信息。

API列表:指的是纳税人在使用开票能力期间所需要的应用程序接口。

# （五）扩展阅读

关于当月发票总额度：由于存在系统临时调整或发票额度人工调整的情况，当月调整后的额度为当月发票总额度。若为调增，则当月发票总额度大于月初发票额度；若为调减，则当月发票总额度小于月初发票额度；若不存在调整，当月发票总额度等于月初发票额度。

需要说明的是，目前税务数字账户首页和蓝字发票开具界面上所显示的“发票总额度”，基本上表达的是“当月发票总额度”的概念。

关于剩余可用发票额度：剩余可用发票额度区分申报前和申报后。剩余可用发票额度（申报前）是指纳税人，在申报月完成对应属期申报前可开具数电票的金额上限（申报前税控发票无法领用，因此不控制其领用金额），其初始化值（每月1日计算）为上月剩余发票额度和本月月初发票额度的较小值。

剩余可用发票额度（申报后）是指纳税人在申报月完成对应属期申报且比对成功后可开具数电票以及领用税控发票的金额上限。等于当月发票总额度减去本月已用发票额度（即本月数电票实际开具金额以及税控发票实际领用的金额）。

需要说明的是，目前税务数字账户首页和蓝字发票开具界面上所显示的“可用发票额度”，基本上表达的是“剩余可用发票额度”的概念。

例如：某企业为按月申报纳税人，3月发票总额度为1000万，3月累计开具800万金额发票，则3月剩余发票额度为200万，若4月月初发票额度为1000万，则企业4月申报前的剩余可用发票额度为3月剩余发票额度与4月月初发票额度中的较小值，即200万。若企业4月15日完成申报，4月1日至4月15日期间开具150万金额发票，则企业4月申报后的剩余可用发票额度为4月发票总额度（1000万）减去本月已用发票额度（150万），即850万。

需注意的是，企业在月初未申报时下载的发票额度的有效期止为当月申报截止日期，超过发票额度有效期止后，无法开具数电票，企业在完成申报或到达发票额度有效期止后，需调整发票额度有效期，并根据税局端返回的有效期更新本地发票额度有效期。

关于全面数字化的电子红字发票（以下简称数电红票）开具：除按政策规定可以修改的单价、数量、金额等要素外，数电红票中的其余要素需与全面数字化的电子蓝字发票（以下简称数电蓝票）一一对应，详细规则可参见版式文件中的相关内容。

关于按需开票：按需开票纳税人在开具发票前同样需要下载发票额度，并且只能在发票额度有效期内使用，不允许超额度开票，在查询发票额度当月发票总额度时，系统返回数据为9999999999999999，企业下载发票额度后，剩余可用发票额度返回数据仍为99999999999999，按需开票纳税人退出按需开票后，退出当月剩余可用发票额度需扣除当月已下载发票额度。

例如：某企业为按需开票纳税人，其按需开票截止时间为5月15日，5月113日起，税务机关将自动为企业赋予当月发票总额度为1000万，若企业在5月1日-15日期间已累计下载发票额度800万，则企业此时查询当月剩余可用发票额度为1000-800=200万，5月1日-31日可再下载的发票额度为200万。

# 三、开发指引

企业在调用乐企平台发起的相关请求报文中禁止使用Unicode码，但是可以使用Unicode码对应的中文。例如★可以出现在开票报文的备注中，但是不能出现\u38996。

# （一）业务场景

为方便理解，下述内容中业务流程图中涉及到的接口编号与第四章-4.1接口清单列表进行对应，编号规则仅适用于本文档，后续乐企1.5平台对所有接口编号设置统一的编号规则。

# 1数电票开具前置

企业在开具发票前可提前将开具发票所需的相关信息获取到本地，待开票时查询本地的数据进行校验。

企业可申请获取所有信息，也可以单独只获取任意一个开票信息更新本地的信息。

# 1.1全流程图

在该场景中获取发票所需信息无严格的先后顺序。

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-30/fcc96c6c-7c35-4d97-9baa-3a4ec13ee8ae/e466c0cc6cf07ec1db7136a0f79d837c37c7a14c6ef8328073948c63b1735f76.jpg)  
蓝字发票业务流程图

红字发票业务流程图  

<table><tr><td colspan="4">乐企数字化电子红字发票开票前置场景</td></tr><tr><td rowspan="9">功能流程图</td><td>销方纳税人</td><td>自有业务系统</td><td>乐企服务端</td></tr><tr><td rowspan="8">获取发票开具前置信息</td><td>接收获取发票开具前置信息请求</td><td>1、获取批量预赋码信息</td></tr><tr><td>获取批量预赋码信息</td><td>1、查询纳税人风险信息</td></tr><tr><td>获取纳税人风险信息</td><td>1、查询纳税人基本信息</td></tr><tr><td>获取纳税人基本信息</td><td>1、查询可用税率</td></tr><tr><td>获取税收分类编码信息</td><td>1、查询税收分类编码信息</td></tr><tr><td>获取红字确认单列表信息</td><td>1、查询红字确认单列表信息</td></tr><tr><td>获取红字确认单明细信息</td><td>1、查询红字确认单明细信息</td></tr><tr><td>结束</td><td>1、查询红字确认单明细信息</td></tr></table>

# 1.2业务规则

# 1.2.1获取批量预赋码信息

查询本地未使用数电票号码段，判断是否低于设定的阈值（例如：低于  $20\%$  等），则需要调用税务局端接口重新获取数电票批量预赋码信息。

数电票号码前2位代表使用年份，禁止跨年度使用。例如：“22”开头的发票号码为2022年度的发票号码，只能在2022年使用，开票日期必须为2022年。企业在2022年开具的数电票，可以在跨年后继续上传，跨年后企业需要重新下载新一年度的数电票号码开具数电票。

接口详情参见“四、接口列表1.获取数电票批量预赋码信息”。

# 1.2.2发票额度管理

发票额度即开票额度，用于控制企业开具数电票的总额度，乐企1.5要求企业自行管理每月数电票的发票额度，以下情况禁止使用发票额度。

$\bullet$  发票额度不在有效期内  
$\bullet$  跨月使用  
$\bullet$  开票总额度大于发票额度

发票额度管理包括下载发票额度和退回发票额度2个功能。

接口详情参见“四、接口列表3.下载/退回发票额度”。

# 1.2.2.1下载发票额度

当企业本地的已下载未使用的发票额度小于需要开具的数电票的额度时，可通过此功能下载发票额度。

建议根据企业自身开票情况，对本地已下载未使用的发票额度设置阈值，当已下载未使用的发票额度小于设置的阈值时，自动触发下载发票额度操作。

# 1.2.2.2退回发票额度

当企业需要在其他平台开具数电票，但是发票额度不足时，企业可通过此接口把下载到本地的发票额度退回至税务局端，以便企业在其他平台开具数电票时。

# 1.2.3调整发票额度有效期

给企业提供调整发票额度有效期接口，企业在月初未申报时下载的发票额度的有效期止为当月申报截止日期，超过发票额度有效期止后，无法开具数电票，企业在完成申报或到达发票额度有效期止后，通过此接口调整发票额度有效期，并根据税局端返回的有效期更新本地发票额度有效期。

接口详情参见“四、接口列表4.调整发票额度有效期”。

# 1.2.4获取纳税人风险信息

定时获取纳税人风险信息，用于企业判断是否可以使用开票能力。

建议企业每24小时获取纳税人风险信息，或者在纳税人风险信息发生变更时手动触发更新。

接口详情参见“四、接口列表5.查询纳税人风险信息”。

# 1.2.5获取纳税人基本信息

定时获取纳税人基本信息，用于企业判断是否使用开票能力、可使用哪些开票。

建议定时获取纳税人基本信息，或者在纳税人基本信息发生变更时手动触发更新。

接口详情参见“四、接口列表6.查询纳税人基本信息”。

# 1.2.6获取可用税收分类编码

定时获取可用税收分类编码，在开具数电票时可依据获取到的税收分类编码判断发票信息是否合规。

建议定时获取税收分类编码。

针对不同的税收分类编码维护了可使用增值税特殊管理内容，即可使用的优惠政策，纳税人在开具数电票时可以根据选择的税收分类编码选择适用的优惠政策，享受税收减免政策。

增值税特殊管理共分为18类，分别是“简易征收”“稀土产品”“免税”“不征税”“先征后退”“100%先征后退”“50%先征后退”“按3%简易征收”“按5%简易征收”“按5%简易征收减按1.5%计征”“即征即退30%”“即征即退50%”“即征即退70%”“即征即退100%”“超税负3%即征即退”“超税负8%即征即退”“超税负12%即征即退”“超税负6%即征即退”。

在开具数电票条件时，根据需求选择符合的优惠政策代码和税率，包括：

优惠政策选择“简易征收”，发票明细“优惠政策标识”项填写“01”，税率限制为3%或5%；

优惠政策选择“稀土产品”，发票明细“优惠政策标识”项填写“02”，“税率”栏次正常填写适用税率；

优惠政策选择“免税”，发票明细“优惠政策标识”项填写“03”，选择免税后，税率为0；

优惠政策选择“不征税”，发票明细“优惠政策标识”项填写“04”，选择不征税后，税率为0，该优惠政策不能混开，但选择不征税的编码为“61300000000000000000代收民航发展基金”时，支持与选择任何优惠政策标识（包含优惠政策标识为空）的“301030101010000000国内航空旅客运输服务”、“301030101020000000国际航空旅客运输服务”、“301030101030000000港澳台航空旅客运输服务”编码混开；选择不征税的编码为“611000000000000000不征税自来水”时，支持与选择任何优惠政策标识（包含优惠政策标识为空）的税收分类编码混开；

优惠政策选择“先征后退”，发票明细“优惠政策标识”项填写“05”，在发票明细的“税率”栏次填写适用税率；

优惠政策选择“100%先征后退”，发票明细“优惠政策标识”项填写“06”，在发票明细的“税率”栏次填写适用税率；

优惠政策选择“50%先征后退”，发票明细“优惠政策标识”项填写“07”，在发票明细的“税率”栏次填写适用税率；

优惠政策选择“按3%简易征收”，发票明细“优惠政策标识”项填写“08”，“税率”栏次限制为  $3\%$  ；

优惠政策选择“按5%简易征收”，发票明细“优惠政策标识”项填写“09”，“税率”栏次限制为  $5\%$  ；

优惠政策选择“按5%简易征收减按1.5%计征”，发票明细“优惠政策标识”项填写“10”，“税率”栏次限制为1.5%，该优惠政策不能与其他优惠政策混开，仅限不动产经营租赁能力可用；

优惠政策选择“即征即退  $30\%$  ”，发票明细“优惠政策标识”项填写“11”，“税率”栏次正常填写适用税率；

优惠政策选择“即征即退  $50\%$  ”，发票明细“优惠政策标识”项填写“12”，“税率”栏次正常填写适用税率；

优惠政策选择“即征即退  $70\%$  ”，发票明细“优惠政策标识”项填写“13”，“税率”栏次正常填写适用税率；

优惠政策选择“即征即退  $100\%$  ”，发票明细“优惠政策标识”项填写“14”，“税率”栏次正常填写适用税率；

优惠政策选择“超税负3%即征即退”，发票明细“优惠政策标识”项填写“15”，“税率”栏

次正常填写适用税率；

优惠政策选择“超税负  $8\%$  即征即退”，发票明细“优惠政策标识”项填写“16”，“税率”栏次正常填写适用税率；

优惠政策选择“超税负12%即征即退”，发票明细“优惠政策标识”项填写“17”，“税率”栏次正常填写适用税率；

优惠政策选择“超税负  $6\%$  即征即退”，发票明细“优惠政策标识”项填写“18”，“税率”栏次正常填写适用税率。

接口详情参见“四、接口列表8.查询税收分类编码信息”。

# 1.2.7获取可用税率

定时获取可用税率，使用在开具数电票时可依据获取到的可用税率判断发票信息是否合规。

建议定时获取可用税率。

接口详情参见“四、接口列表7.查询可用税率信息”。

# 1.2.8获取数电红字确认单列表

从税务局端获取数电红字确认单列表信息，以便于后期开具红字发票以及红字发票确认时进行业务校验。

建议企业定时下载/更新数电红字确认单列表信息,或在接收数电红字确认单、数电红字确认单变更时手工获取数电红字确认单列表信息。

根据红字确认单状态判断蓝字发票状态，具体如下：

1、当红字确认单状态为01无需确认时，蓝字发票购方未进行入账或勾选抵扣操作，红字确认单由销方发起无需确认。  
2、当红字确认单状态为02销方录入待购方确认时，蓝字发票购方已进行入账或勾选抵扣操作，销方申请红字确认单待购方确认。  
3、当红字确认单状态为03购方录入待销方确认时，蓝字发票购方已进行入账或勾选抵扣操作，购方申请红字确认单待销方确认。

接口详情参见“四、接口列表11.查询数电红字确认单列表信息”。

# 1.2.9获取数电红字确认单明细

从税务局端获取数电红字确认单明细信息，以便于后期开具红字发票以及红字发票确认时进行业务校验。

建议企业定时下载/更新数电红字确认单明细信息,或在接收数电红字确认单明细、数电红字确认单明细变更时手工获取数电红字确认单明细信息。

根据红字确认单状态判断蓝字发票状态，具体如下：

1、当红字确认单状态为01无需确认时，蓝字发票购方未进行入账或勾选抵扣操作，红字确认单由销方发起无需确认。  
2、当红字确认单状态为02销方录入待购方确认时，蓝字发票购方已进行入账或勾选抵扣操作，销方申请红字确认单待购方确认。

3、当红字确认单状态为03购方录入待销方确认时，蓝字发票购方已进行入账或勾选抵扣操作，购方申请红字确认单待销方确认。

接口详情参见“四、接口列表9.查询数电红字确认单明细信息”。

# 2数电蓝字发票开具

# 2.1全流程图

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-30/fcc96c6c-7c35-4d97-9baa-3a4ec13ee8ae/aa1ba5b893da9d91e6b8ec78cc913877c9b25bf76e5bea966c0e1add9cd46e68.jpg)  
业务流程图

# 2.2业务规则

# 2.2.1判断纳税人开票资格

校验纳税人是否具备数电蓝字发票开票资格，包括风险纳税人信息校验和纳税人资格校验。

查询本地保存的纳税人风险信息，校验纳税人是否为风险纳税人，禁止风险等级高的纳税人开具发票。

查询本地保存的纳税人基本信息，判断纳税人是否具备开具数电蓝字发票资格。

# 2.2.1.1判断逻辑

根据查询的纳税人风险信息进行校验，当满足以下任意条件时禁止开具数电蓝字发票。

纳税人风险信息中“风险纳税人类型”为“I类”。  
纳税人风险信息中“纳税人预警级别”为“红色预警”。  
纳税人风险信息中“风险纳税人标志”为“Y（风险纳税人）”。

根据查询的纳税人基本信息进行校验，当发生以下任意条件时禁止开具数电蓝字发票。

纳税人信息中“纳税人状态”不是“03（正常）”、“09（报验）”中的任意一个。

# 2.2.2发票号段结余校验

判断本地是否还有未使用的数电票，若无未使用的数电票，需调用税务局端接口重新获取数电票批量预赋码信息，详情参见“1数电票开具前置1.2.1获取批量预赋码信息”。

# 2.2.3获取开票基础信息

查询本地保存的税收分类编码信息和可用税率信息。

# 2.2.4录入、校验发票信息

依据开票能力发票开具的要求，录入发票信息，并依据发票开具规则对发票信息进行业务逻辑校验，主要包括合规性校验、数值校验。

# 2.2.4.1合规性校验

合规性校验主要对输入参数的类型、长度、是否必填、码值进行校验。以下任意一项不满足要求时，阻断发票开具。校验规则如下：

$\bullet$  发票号码，必填，长度20位，由数字组成，前2位为年份后2位。  
- 蓝字发票标志，必填，取值范围为“0”、“1”。  
$\bullet$  平台编号，必填，最大长度20位。  
$\bullet$  服务器地址，必填，长度20位。  
- mac地址，必填，长度20位。  
CPU序列号，选填，长度20位。  
主板序列号，选填，长度20位。  
$\bullet$  发票票种, 必填, 取值范围为 “ 01 ”、“ 02 ”。  
购买方自然人标志，选填，取值范围为“Y”、“N”。

$\bullet$  特定要素，选填，必须为空。  
$\bullet$  区域代码，必填，最大长度20位。  

- 收购发票类型代码，选填，取值范围为“空”、“01”、“02”、“03”。  
- 差额征税类型代码，选填，取值范围为“空”、“01”、“02”。  
出口业务适用政策代码，选填，取值范围为“空”、“01”、“02”、“03”。  
- 增值税即征即退代码，选填，取值范围为“空”、“01”、“02”、“03”、“04”、“05”、“06”、“07”、“08”、“09”、“10”、“11”、“12”。  
销售方纳税人识别号，必填，最大长度20位，由数字和大写字母组成。  
销售方名称，必填，最大长度300位。  
销售方地址，选填，最大长度300位。  
销售方电话，选填，最大长度60位。  
销售方开户行，选填，最大长度120位。  
销售方账号，选填，最大长度50位。  
购买方纳税人识别号，选填，最大长度20位（开具数电专票时，必填）。  
购买方名称，必填，最大长度300位。  
购买方地址，选填，最大长度300位。  
购买方电话，选填，最大长度60位。  
购买方开户行名称，选填，最大长度120位。  
购买方开户行银行账号，选填，最大长度100位。  
经办人，选填，最大长度150位。  
经办人身份证件号码，选填，最大长度30位。  
经办人联系电话，选填，最大长度60位。  
$\bullet$  合计金额，必填，最大长度18位，最多2位小数。  
$\bullet$  合计税额，必填，最大长度18位，最多2位小数。  
价税合计，必填，最大长度18位，最多2位小数。  
收款银行名称，选填，最大长度120位。  
收款银行账号，选填，最大长度100位。  
$\bullet$  结算方式, 选填, 取值范围为 “01”、“02”、“03”、“04”、“05”、“99”。  
$\bullet$  应税行为发生地，选填，最大长度11位。  
$\bullet$  开票人，必填，最大长度300位。

$\bullet$  开票人证件号码，选填，最大长度30位。  
$\bullet$  开票人证件类型，选填，最大长度4位。  
$\bullet$  对应蓝字发票号码，选填，长度20位。  

- 红字确认信息单编号，选填，最大长度20位。  
- 红字确认单uuid，选填，最大长度32位。  
$\bullet$  备注，选填，最大长度450位。  
$\bullet$  开票日期，必填，格式必须是“yyyy-MM-dd HH:mm:ss”。  
是否展示销售方银行账号标签，选填，最大长度1位。  
是否展示购买方银行账号标签，选填，最大长度1位  
收款人姓名，选填，最大长度150位。  
$\bullet$  复核人姓名，选填，最大程度75位。  
$\bullet$  明细序号，必填，最大长度8位。  
$\bullet$  对应蓝字发票明细序号，选填，最大长度8位。  
货物或应税劳务、服务名称，必填，最大长度300位。  
$\bullet$  商品服务简称，必填，最大长度120位。  
项目名称，必填，最大长度600位。  
$\bullet$  规格型号，选填，最大长度150位。  
$\bullet$  单位，选填，最大长度300位。  
数量，选填（如“单价”非空，则必填），最大长度25位。  
$\bullet$  单价，选填（如“数量”非空，则必填），最大长度25位。  
- 金额，必填，最大长度18位，最多2位小数。  
$\bullet$  增值税税率/征收率，必填，最大长度16位，最多6位小数。必须在可用税率信息中存在。  
$\bullet$  税额，必填，最大长度18位，最多2位小数。  
含税金额，必填，最大长度18位，最多2位小数。  
$\bullet$  扣除额，选填，最大长度18位，最多2位小数。  
$\bullet$  商品和服务税收分类合并编码，必填，最大长度19位。必须在商品编码信息中存在。  
$\bullet$  发票行性质, 必填, 取值范围为 “ 00 ”、“ 01 ”、“ 02 ”。  
- 优惠政策标识，选填，不为空时取值范围为“01”、“02”、“03”、“04”、“05”、“06”、“07”、“08”、“09”、“10”、“11”、“12”、“13”、“14”、“15”、“16”、“17”、“18”。

● 附加要素名称，选填，最大长度200位。  
$\bullet$  附加要素类型，选填，最大长度200位。  
$\bullet$  附加要素值，选填，最大长度200位。  
$\bullet$  序号，选填，最大长度8位。  

- 凭证类型，选填，取值范围为01、“02”、“03”、“04”、“05”、“06”、“07”、“08”、“09”。  
$\bullet$  发票代码，选填，最大长度12位。  
$\bullet$  发票号码，选填，最大长度30位。  
差额凭证号码，选填，最大长度40位。  
- 开具日期，选填，格式必须为“yyyy-MM-dd”。  
$\bullet$  凭证合计金额，选填，最大长度18位，最多两位小数。  
●本次扣除金额，选填，最大长度18位，最多两位小数。  
● 备注，选填最大长度450位。

# 2.2.4.2数据校验

单行金额校验：|单价*数量-金额|<=0.01。  
- 汇总金额校验：|所有商品行金额之和-合计金额|<=0.01。  
$\bullet$  单行税额校验：|金额*税率-税额|<=0.06。  
- 汇总税额校验：|金额*税率（第1行）+……+金额*税率（第N行）-税额合计|<=1.27。  
折扣行校验规则：

1、折扣行与被折扣行“对应蓝字发票明细序号”、“扣除额”必须为空。  
2、折扣行“规格型号”、“单价”、“单位”、“数量”必须为空；  
3、折扣行“明细序号”、“金额”、“税额”、“含税金额”按照实际情况填写；  
4、折扣行发票行性质必须填写“01（折扣行）”。  
5、折扣行其他字段必须与被折扣行一致，包括“项目名称”，“货物或应税劳务、服务名称”，“商品服务简称”，“增值税税率/征收率”，“商品和服务税收分类合并编码”，“优惠政策标识”。

- 差额征税类型代码非空时，明细行只能是一行，不允许开具折扣行。差额征税类型代码为“01：全额开票”时， $0<=$  扣除额<=含税金额；差额征税类型代码为“02：差额开票”时， $0<$  扣除额<=含税金额。  
差额征税开票税额、金额校验规则：

# 2.2.4.3业务校验规则

$\bullet$  发票上传接口中“平台编号”字段值必须为直连单位ID。  
- 开具具有农产品编码且税率不为  $13\%$  的数电专票时，发票上传后将被标注为农产品专票，特定要素为20。  
当企业开票时判断购方是否为自然人，并按照以下业务规则开具发票：

# （一）提示语规则

1. “是否开票给自然人”标识旁新增“未勾选则默认为企业”提示。

2. 对于无特定要素标签的电子发票（普通发票）和增值税普通发票，当勾选“是否开票给自然人”时，提示语为：“除特定业务外的普通发票，如受票方（发票抬头）为自然人，只需提供姓名或姓；如受票方（发票抬头）为自然人，并要求能将发票归集在个人票夹中展示，需提供姓名及身份证号；如受票方（发票抬头）为个体工商户，需提供社会统一信用代码或纳税人识别号，请勿勾选此标识。如您的姓名为张某某，可在名称栏次填写：张某某、张先生或张女士。”。  
3. 对于除无特定要素标签的电子发票（普通发票）和增值税普通发票外的发票，当勾选“是否开票给自然人”时，提示语为“如受票方（发票抬头）为自然人，并要求能将发票归集在个人票夹中展示，需提供姓名及身份证号；如受票方（发票抬头）为个体工商户，需提供社会统一信用代码或纳税人识别号，请勿勾选此标识。”。

# （二）增加受票方信息校验

对于无特定要素标签的电子发票（普通发票）和增值税普通发票，增加受票方信息校验，具体如下：

1. 当勾选“是否开票给自然人”时，【购买方名称】录入内容必须大于一个长度（一个汉字、数字、字母、符号）。  
2. 未勾选“是否开票给自然人”时，【购买方名称】录入内容如果小于等于4个长度（一个汉字、数字、字母、符号），点击开具发票则弹窗提示：“请您检查填写的名称，确认是否开票给自然人，如为自然人请勾选‘是否开票给自然人’标识。”点击确定，可继续开票。

# (三) “（个人）”标注规则

1. 当勾选“是否开票给自然人”时，所开具出的发票其【购买方名称】追加“（个人）”。例如：开票时【购买方名称】填写内容为“张先生”，则开具出的发票【购买方名称】内容为“张先生（个人）”。【购买方名称】已标注“（个人）”的蓝字发票冲红，开具对应的红字发票与蓝字发票保持一致【购买方名称】标注“（个人）”。

- 单张发票明细行最多不能超过5000条，超过5000条则阻断发票上传；建议企业开具发票明细行控制在2000条以下。  
- 开具发票时，行业代码为63开头的电信企业可以使用汇总项电信编码开具发票，规则如下：

1、电信企业提供电信服务使用“303010000000000000”开票时，税率必须为  $9 \%$ , 可以开具增值税专用发票、增值税普通发票; 使用 “303020000000000000 (增值电信服务)” 开具发票时, 税率必须为  $6 \%$ , 可以开具增值税专用发票、增值税普通发票;  
2、电信企业预付费业务、后付费业务使用“30300000000000000（电信服务）”汇总项开具发票时，税率必须为  $0\%$  ，优惠政策标识必须为“04不征税”，税额必须为“0.00”，只能开具增值税普

通发票；

3、电信企业取得预付卡销售和充值款项按“601000000000000000（预付卡销售和充值）”非汇总项开具发票时，税率必须为  $0\%$  ，优惠政策标识必须为“04不征税”，税额必须为“0.00”，只能开具增值税普通发票。

除以上情况外，不允许使用“是否汇总项”为“Y”的编码开具发票。

差额征税开票逻辑校验：

1、开具差额征税发票时，只能使用基础商编表中“差额征税”标志为Y且在差额商编表内存在的商品编码；且开具差额征税发票时，只能使用差额商编中对应的税率及征收率。一般纳税人正常情况下只能使用税率，使用简易征收相关优惠政策时以及在有原税率授权情况下才能使用征收率；小规模及转登记纳税人正常情况下只能使用小规模纳税人税收征收率，转登记纳税人有原税率授权情况下才能使用一般纳税人的税率及征收率。  
2、所有的差额征收编码都可以开具“差额征税-全额开票”的普票；差额征收编码是否可以差额征税-差额开票、差额开票是否可以开专票、全额开票是否可以开专票根据差额征收编码表标志判断。  
3、选择110030101000000000 自来水商品编码、304080101000000000 物业管理服务商品编码开具差额征收方式，需要纳税人主附国标行业类别（行业代码为702或7020）是物业管理服务才能开具。  
4、仅银行业金融机构（行业代码为662/663开头的货币银行服务及非货币银行服务机构）和金融资产管理公司（行业代码为6950的金融资产管理公司）中的增值税一般纳税人在“差额征税-差额开票”模式下选择以下商品编码时，允许使用下表中对应的税率开票：

<table><tr><td>商品和服务税收编码</td><td>货物和劳务名称</td><td>商品和服务分类简称</td><td>税率</td></tr><tr><td>501010200000000000</td><td>取得的住宅</td><td>不动产</td><td>9%</td></tr><tr><td>501019900000000000</td><td>其他住房</td><td>不动产</td><td>9%</td></tr><tr><td>501020200000000000</td><td>取得的商业用房</td><td>不动产</td><td>9%</td></tr><tr><td>501029900000000000</td><td>其他商业用房</td><td>不动产</td><td>9%</td></tr><tr><td>501990000000000000</td><td>其他建筑物</td><td>不动产</td><td>9%</td></tr><tr><td>50200000000000000</td><td>构筑物</td><td>不动产</td><td>9%</td></tr><tr><td>503000000000000000</td><td>其他不动产</td><td>不动产</td><td>9%</td></tr></table>

5、扣除额不为0的时候必须填写差额扣除清单，且所有差额扣除凭证“本次扣除金额”之和应当等于扣除额。差额扣除清单根据凭证类型具有不同填写要求，如下表《差额扣除清单》所示，其中灰色格子要求必须为空，空白格为选填项；开具红字发票时差额清单各字段为空。具体要求如下：

<table><tr><td colspan="9">《差额扣除清单》</td></tr><tr><td>序号</td><td>凭证类型</td><td>发票代码</td><td>发票号码</td><td>凭证号码</td><td>开具日期</td><td>凭证合计金额</td><td>本次扣除金额</td><td>备注</td></tr><tr><td>1</td><td>数电票</td><td>—</td><td>必录项</td><td>—</td><td>必录项</td><td>必录项</td><td>必录项</td><td></td></tr><tr><td>2</td><td>增值税专</td><td>必录项</td><td>必录项</td><td>—</td><td>必录项</td><td>必录项</td><td>必录项</td><td></td></tr><tr><td></td><td>用发票</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>3</td><td>增值税普通发票</td><td>必录项</td><td>必录项</td><td>—</td><td>必录项</td><td>必录项</td><td>必录项</td><td></td></tr><tr><td>4</td><td>其他发票</td><td></td><td></td><td>-</td><td></td><td>必录项</td><td>必录项</td><td>必录项</td></tr><tr><td>5</td><td>营业税发票</td><td>必录项</td><td>必录项</td><td>-</td><td>必录项</td><td>必录项</td><td>必录项</td><td></td></tr><tr><td>6</td><td>财政票据</td><td>——</td><td>——</td><td></td><td></td><td>必录项</td><td>必录项</td><td></td></tr><tr><td>7</td><td>法院裁决书</td><td>——</td><td>——</td><td></td><td></td><td>必录项</td><td>必录项</td><td></td></tr><tr><td>8</td><td>契税完税凭证</td><td>——</td><td>——</td><td></td><td></td><td>必录项</td><td>必录项</td><td></td></tr><tr><td>9</td><td>其他扣除凭证</td><td>——</td><td>——</td><td></td><td></td><td>必录项</td><td>必录项</td><td>必录项</td></tr></table>

(1) 本次扣除金额必须小于等于凭证合计金额。  
(2）当凭证类型为其他发票或其他扣除凭证时，备注必填，要求说明其他发票名称及其他扣除凭证名称。

● 发票上传时间与开票时间间隔应当小于48小时。

# 2.2.5校验发票额度

获取企业本地已下载未使用发票额度，校验纳税人已下载未使用发票额度和发票金额，若已下载未使用发票额度-开票金额<0时，阻断开具数电票开具或修改发票信息后重新开具；若已下载未使用发票额度-开票金额>=0，更新本地已下载未使用发票额度。

# 2.2.5.1判断逻辑

校验已下载未使用发票额度，当满足以下任意条件时阻断开具数电蓝字发票。

查询已下载未使用发票额度失败  
$\bullet$  发票额度信息中“已下载未使用发票额度”小于开票金额。

# 2.2.6发票赋码

从本地数电票号码段中给要开具的数电票依次分配不重复的数电票号码，若本地数电票号码已使用完毕，调用操作。

# 2.2.7发票上传

发票赋码成功后，首先在本地保存数电蓝字发票预开具信息（发票状态为“预开具成功”），调用税务局端《数电票上传》接口预上传数电蓝字发票，并依据返回的结果，更新本地发票预上传结果，具体参见“四、接口列表10.数电票上传”。

# 2.2.8查询发票上传结果

发票上传成功后，间隔10S依据发票上传返回的“受理流水号”调用税务局端《查询数电票上传结果》接口查询数电蓝字发票是否接收成功，并依据返回的发票开具结果，更新本地发票开具结果，具体参见“四、接口列表12.查询数电票上传结果”。

# 3数电红字发票开具

# 3.1数电红字确认单申请

# 3.1.1全流程图

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-30/fcc96c6c-7c35-4d97-9baa-3a4ec13ee8ae/fa42625a0f6fc571b4a0087f0c1ef09a0f39ef1d1ff8fdab9c1cef5d530060a5.jpg)  
业务流程图

# 3.1.2业务规则

# 3.1.2.1判断纳税人申请资格

校验纳税人是否具备数电红字确认单申请资格，包括风险纳税人信息校验和纳税人资格校验。

查询本地保存的纳税人风险信息，校验纳税人是否为风险纳税人，禁止风险等级高的纳税人申请数电红字确认单。

查询本地保存的纳税人基本信息，判断纳税人是否具备申请数电红字确认单资格。

# 3.1.2.1.1判断逻辑

根据查询的纳税人风险信息进行校验，当满足以下任意条件时禁止申请数电红字确认单。

纳税人风险信息中“风险纳税人类型”为“I类（高风险）”。  
纳税人风险信息中“纳税人预警级别”为“红色预警”。  
纳税人风险信息中“风险纳税人标志”为“Y（风险纳税人）”。

根据查询的纳税人基本信息进行校验，当发生以下任意条件时禁止开具数电红字确认单。

- 纳税人信息中“纳税人状态”不是“03（正常）”、“09（报验）”中的任意一个。

# 3.1.2.2本地判断蓝字发票是否可红冲

查询本地保存蓝字发票信息和蓝字发票勾选信息，校验数电蓝字发票是否具备红冲条件。

本地若无蓝票信息，需通过乐企归集能力中“批量发票下载申请”、“批量发票下载申请反馈”、“查询增量发票下载信息”接口查询蓝票信息。

本地若无蓝票状态信息，需通过“发票用途状态信息查询”接口查询蓝字发票状态信息。

# 3.1.2.2.1判断逻辑

对从本地查询的蓝字发票、蓝字发票勾选信息、数电红字发票信息进行判断，满足以下任意条件时禁止开具数电红字确认单。

- 对应数电蓝字发票状态为“作废”、“锁定”或“异常凭证”。  
- 对应数电蓝字发票增值税用途为待退税、已退税、已抵扣（改退）、已代办退税、不予退税且不予抵扣时。  
●校验对应数电蓝字发票税收优惠类标签明细，当“冬奥会退税标签”为“已用于冬奥会退税”时。  
通过“发票用途状态信息查询”接口查询的信息判断是否触发以上禁止开具的条件，对应如下：

<table><tr><td>字段</td><td>码值</td><td>蓝字发票状态</td></tr><tr><td>异常凭证状态</td><td>2</td><td>异常凭证</td></tr><tr><td>红字锁定标识</td><td>Y</td><td>锁定</td></tr><tr><td rowspan="2">发票状态</td><td>2</td><td>作废</td></tr><tr><td>11</td><td>冬奥退税</td></tr><tr><td rowspan="6">发票用途</td><td>2</td><td>已申请退税</td></tr><tr><td>3</td><td>已申请代办退税</td></tr><tr><td>5</td><td>已申请代办退税（历史数据）</td></tr><tr><td>7</td><td>内销转出口</td></tr><tr><td>9</td><td>准予退税</td></tr><tr><td>10</td><td>不予退税</td></tr></table>

# 3.1.2.3录入、校验数电红字确认单信息

依据开票能力数电红字确认单要求，录入数电红字确认单信息，并依据数电红字确认单申请规则对发票信息进行业务逻辑校验，主要包括合规性校验、数值校验。

# 3.1.2.3.1合规性校验

合规性校验主要对输入参数的类型、长度、是否必填、码值进行校验。以下任意一项不满足要求时，阻断发票开具。校验规则如下：

- 录入方身份，必填，取值范围为“0”、“1”。  
销售方纳税人识别号，必填，最大长度20位，由数字和大写字母组成。  
销售方名称，必填，最大长度300位。  
购买方纳税人识别号，选填，最大长度20位。  
购买方名称，必填，最大长度300位。  
- 蓝字发票代码，选填，最大长度12位。  
- 蓝字发票号码，必填，最大长度20位。  
$\bullet$  是否纸质发票标志, 必填, 取值范围为 “Y”、“N”。  
- 蓝字发票开票日期，必填，格式为yyyy-MM-dd HH:mm:ss。  
- 蓝字发票合计金额，必填，最大长度18位，最多2位小数。  
- 蓝字发票合计税额，必填，最大长度18位，最多2位小数。  
- 蓝字发票发票票种代码，必填，取值范围为“01”、“02”、“03”、“04”。  
- 蓝字发票特定要素类型代码，选填，取值范围为“01”、“02”、“03”、“04”、“05”、“06”、“07”、“08”、“09”、“10”、“11”、“12”、“13”、“14”、“15”、“16”、“17”、“18”、“20”。  
- 红字冲销金额，必填，最大长度18位，最多2位小数。  
- 红字冲销税额，必填，最大长度18位，最多2位小数。  
- 红字发票冲红原因代码，必填，取值范围为“01”、“02”、“03”、“04”。  
$\bullet$  序号, 必填, 最大长度 8 位, 从 1 开始。  
- 蓝字发票明细序号，必填，最大长度8位。  
- 商品和服务税收分类合并编码，必填，最大长度19位。必须在商品编码信息中存在。  
- 货物或应税劳务、服务名称，必填，最大长度300位。  
$\bullet$  商品服务简称，必填，最大长度120位。  
项目名称，必填，最大长度600位。  
$\bullet$  规格型号，选填，最大长度150位。  
$\bullet$  单位，选填，最大长度300位。

- 单价，选填（如“数量”非空，则必填），最大长度25位。  
数量，选填（如“单价”非空，则必填），最大长度25位。  
- 金额，必填，最大长度18位，最多2位小数。  
$\bullet$  税率，必填，最大长度16位，最多6位小数。必须在可用税率信息中存在。  
税额，必填，最大长度18位，最多2位小数。

# 3.1.2.3.2数据校验

- 含税金额=税额+金额，不能有误差。  
- 红票开具金额<=对应蓝字发票开具金额。

# 3.1.2.3.3业务逻辑校验

- 红字确认单的商品金额必须为负数，税额不为正数。  
$\bullet$  对应数电蓝字发票带折扣行时，将折扣金额、税额分摊反映在对应的项目名称行上，再和红字发票进行比对。  
- 蓝字增值税专用发票只能用增值税专用发票冲红；蓝字普通发票只能用普通发票进行冲红。  
$\bullet$  对应数电蓝字发票开具过红字发票时，系统对冲红的“对应蓝字发票明细序号”行累计数量、累计金额和累计税额进行监控。当累计开具红字发票的数量以及负数金额或者税额绝对值之和超过原数电蓝字发票时，不允许其继续开具红字发票。  
- 当蓝字发票对应的“增值税用途标签”为空、“消费税用途标签”为“未勾选库存”、“入账状态标签”为“未入账”或“已入账撤销”时，红字信息只允许销售方发起（除非蓝字发票为收购发票）且只能进行全额冲红。  
- “红冲原因”为“开票有误”时，必须全额红冲，并且明细单价、金额、数量必须和蓝字发票保持一致。当蓝字发票对应的“增值税优惠用途标签”为“待农产品全额加计扣除”或“已用于农产品全额加计扣除”的，必须全额红冲；“待农产品部分加计扣除”或“已用于农产品部分加计扣除”的，第一次红冲只能对未加计部分全额冲红或对这张蓝票全额红冲，第二次红冲仅允许对剩余部分（即已加计部分）全额红冲。  
- “红冲原因”为“销货退回”时，只允许修改数量，不允许修改单价。  
“红冲原因”为“服务中止”时，允许修改总金额和数量，不允许修改单价。  
“红冲原因”为“销售折让”时，单价、数量必须为空。  
- 商品服务编码为以1、2开头的冲红原因不允许选择“服务中止”，商品服务编码为以3开头的冲红原因不允许选择“销售退回”，兼营销售则不对红字原因进行控制。  
- 对于税控发票，申请红字确认单时，如果税控蓝票项目名称为 $^{*}\mathrm{A}^{*}\mathrm{B}$ ，红字确认单项目名称字段填写税控蓝字发票项目名称第二个 $^{*}$ 号之后的内容，即B。  
●特定要素为“20”的蓝字数电专票申请红字确认单时，红字确认单“蓝字发票特定要素类型代码”传空，红字确认单申请成功后“蓝字发票特定要素类型代码”将被调整为“20”。  
红冲差额征税蓝票时，必须全额红冲。

# 3.1.2.4红字确认单申请

数电红字确认单录入校验通过后，首先在本地保存数电红字确认单申请信息，调用税务局端《数电红字确认单申请》接口将预申请数电红字确认单上传至税务局端，如果返回成功则表明预申请数电红字确认单上传成功，具体参见“四、接口列表13.数电红字确认单申请”。

# 3.2数电红字确认单确认

# 3.2.1全流程图

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-30/fcc96c6c-7c35-4d97-9baa-3a4ec13ee8ae/24d69ae307904bd4c360048c7eee84e165c03ed6a2fa4aba74a622b0904eb35d.jpg)  
业务流程图

# 3.2.2业务规则

# 3.2.2.1判断纳税人确认资格

校验纳税人是否具备数电红字确认单确认资格，包括风险纳税人信息校验和纳税人资格校验。

查询本地保存的纳税人风险信息，校验纳税人是否为风险纳税人，禁止风险等级高的纳税人确认红字确认单。

查询本地保存的纳税人基本信息，判断纳税人是否具备确认红字确认单的资格。

# 3.2.2.1.1判断逻辑

根据查询的纳税人风险信息进行校验，当满足以下任意条件时禁止确认红字确认单。

纳税人风险信息中“风险纳税人类型”为“I类（高风险）”。  
纳税人风险信息中“纳税人预警级别”为“红色预警”。

纳税人风险信息中“风险纳税人标志”为“Y（风险纳税人）”。

根据查询的纳税人基本信息进行校验，当发生以下任意条件时禁止开具数电蓝字发票。

- 纳税人信息中“纳税人状态”不是“03（正常）”、“09（报验）”中的任意一个。

# 3.2.2.2查询数电红字确认单信息

从本地查询数电红字确认单信息，判断红字确认单是否可以确认。

# 3.2.2.2.1判断逻辑

根据查询的数电红字确认单信息进行校验，当满足以下任意条件时禁止确认数电红字确认单。

$\bullet$  查询数电红字确认单信息失败，本地无数电红字确认单信息  
- 红字确认单状态非待确认状态。

# 3.2.2.3选择、确认数电红字确认单

从查询出的数电红字确认单中选择需要确认的数电红字确认单，并选择确认结果。

# 3.2.2.4 上传数电红字确认单确认信息

调用《数电红字确认单确认》接口向税务局端上传数电红字确认单确认结果，包括：同意、不同意和撤销，并更新数电红字确认单确认信息上传结果，具体参见“四、接口列表14.数电红字确认单确认”。

红字确认单撤销时要求红字确认单状态为有效且未开具红票，红字确认单撤销只能由最后操作方申请，具体包含以下规则：

1、购买方未对蓝字发票做勾选/入账操作，销售方申请红字确认单，这时红字确认单状态为“01”，此时只允许销售方撤销。  
2、购买方对蓝字发票做勾选/入账操作，销售方申请红字确认单，购买方未确认，这时红字确认单状态为“02”，此时只允许销售方撤销。  
3、购买方对蓝字发票做勾选/入账操作，销售方申请红字确认单，购买方已确认，这时红字确认单状态为“04”，此时只允许购买方撤销。  
4、购买方对蓝字发票做勾选/入账操作，购买方申请红字确认单，销售方未确认，这时红字确认单状态为“03”，此时只允许购买方撤销。  
5、购买方对蓝字发票做勾选/入账操作，购买方申请红字确认单，销售方已确认，这时红字确认单状态为“04”，此时只允许销售方撤销。

# 3.3数电红字发票开具

# 3.3.1.全流程图

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-30/fcc96c6c-7c35-4d97-9baa-3a4ec13ee8ae/ccbf84ea5c6c2c18814f288e3a5fa6bd67627f52c24c09917778ee3b8ff54c66.jpg)  
业务流程图

# 3.3.2业务规则

# 3.3.2.1校验红字确认单信息

查询本地保存的红字确认单信息，判断是否存在红字确认单信息以及红字确认单状态是否正常。

查询本地保存的红字确认单信息，校验红字确认单是否可用。

# 3.3.2.1.1判断逻辑

根据查询的红字确认单信息进行校验，当满足以下任意条件时禁止开具数电红字发票。

未查询到红字确认单信息，本地红字确认单信息。  
数电红字确认单信息状态不正确。

# 3.3.2.2判断纳税人开票资格

校验纳税人是否具备数电红字发票开票资格，包括风险纳税人信息校验和纳税人资格校验。

查询本地保存的纳税人风险信息，校验纳税人是否为风险纳税人，禁止风险等级高的纳税人开具发票。

查询本地保存的纳税人基本信息，判断纳税人是否具备开具数电红字发票资格。

# 3.3.2.2.1判断逻辑

根据查询的纳税人风险信息进行校验，当满足以下任意条件时禁止开具数电红字发票。

纳税人风险信息中“风险纳税人类型”为“I类”。  
纳税人风险信息中“纳税人预警级别”为“红色预警”。  
纳税人风险信息中“风险纳税人标志”为“Y（风险纳税人）”。

根据查询的纳税人基本信息进行校验，当发生以下任意条件时禁止开具数电红字发票。

- 纳税人信息中“纳税人状态”不是“03（正常）”、“09（报验）”中的任意一个。

# 3.3.2.3发票号段结余校验

判断本地是否还有未使用的数电票，若无未使用的数电票，需调用税务局端接口重新获取数电票批量预赋码信息，详情参见“1数电票开具前置1.2.1获取批量预赋码信息”。

# 3.3.2.4录入、校验发票信息

依据开票能力红字发票开具的要求，依据红字确认单录入发票信息，并依据发票开具规则对发票信息进行业务逻辑校验，主要包括合规性校验、数值校验。

# 3.3.2.4.1合规性校验

合规性校验主要对输入参数的类型、长度、是否必填、码值进行校验。以下任意一项不满足要求时，阻断发票开具。校验规则如下：

$\bullet$  发票号码，必填，长度20位，由数字组成，前2位为年份后2位。  
- 蓝字发票标志，必填，取值范围为“0”、“1”。  
$\bullet$  平台编号，必填，最大长度20位。  
$\bullet$  服务器地址，必填，长度20位。  
$\bullet$  mac地址，必填，长度20位。  
CPU序列号，选填，长度20位。  
主板序列号，选填，长度20位。  
$\bullet$  发票票种, 必填, 取值范围为 “ 01 ”、“ 02 ”。

购买方自然人标志，选填，取值范围为“Y”、“N”。  
$\bullet$  特定要素，选填，必须为空。  
$\bullet$  区域代码，必填，最大长度20位。  

- 收购发票类型代码，选填，取值范围为“空”、“01”、“02”、“03”。  
- 差额征税类型代码，选填，取值范围为“空”、“01”、“02”。  
- 出口业务适用政策代码，选填，取值范围为“空”、“01”、“02”、“03”。  
- 增值税即征即退代码，选填，取值范围为“空”、“01”、“02”、“03”、“04”、“05”、“06”、“07”、“08”、“09”、“10”、“11”、“12”。  
销售方纳税人识别号，必填，最大长度20位，由数字和大写字母组成。  
销售方名称，必填，最大长度300位。  
销售方地址，选填，最大长度300位。  
销售方电话，选填，最大长度60位。  
销售方开户行，选填，最大长度120位。  
销售方账号，选填，最大长度50位。  
购买方纳税人识别号，选填，最大长度20位（开具数电专票时，必填）。  
购买方名称，必填，最大长度300位。  
购买方地址，选填，最大长度300位。  
购买方电话，选填，最大长度60位。  
购买方开户行名称，选填，最大长度120位。  
购买方开户行银行账号，选填，最大长度50位。  
经办人，选填，最大长度150位。  
$\bullet$  经办人身份证件号码，选填，最大长度30位。  
- 经办人联系电话，选填，最大长度60位。  
$\bullet$  合计金额，必填，最大长度18位，最多2位小数。  
- 合计税额，必填，最大长度18位，最多2位小数。  
价税合计，必填，最大长度18位，最多2位小数。  
收款银行名称，选填，最大长度120位。  
收款银行账号，选填，最大长度100位。  
$\bullet$  结算方式, 选填, 取值范围为 “01”、“02”、“03”、“04”、“05”、“99”。  
$\bullet$  应税行为发生地，选填，最大长度11位。

$\bullet$  开票人，必填，最大长度300位。  
$\bullet$  开票人证件号码，选填，最大长度30位。  
$\bullet$  开票人证件类型，选填，最大长度4位。  
$\bullet$  对应蓝字发票号码，必填，长度20位。  

- 红字确认信息单编号，必填，最大长度20位。  
- 红字确认单uuid，必填，最大长度32位。  
●备注，选填，最大长度450位。  
$\bullet$  开票日期，必填，格式必须是“yyyy-MM-dd HH:mm:ss”。  
是否展示销售方银行账号标签，选填，最大长度1位。  
是否展示购买方银行账号标签，选填，最大长度1位。  
●收款人姓名，选填，最大长度150位。  
复核人姓名，选填，最大程度75位。  
● 明细序号，必填，最大长度8位。  
$\bullet$  对应蓝字发票明细序号，必填，最大长度8位。  
●货物或应税劳务、服务名称，必填，最大长度300位。  
$\bullet$  商品服务简称，必填，最大长度120位。  
项目名称，必填，最大长度600位。  
$\bullet$  规格型号，选填，最大长度150位。  
$\bullet$  单位，选填，最大长度300位。  
数量，选填（如“单价”非空，则必填），最大长度25位。  
$\bullet$  单价，选填（如“数量”非空，则必填），最大长度25位。  
●金额，必填，最大长度18位，最多2位小数。  
$\bullet$  增值税税率/征收率，必填，最大长度16位，最多6位小数。必须在可用税率信息中存在。  
●税额，必填，最大长度18位，最多2位小数。  
$\bullet$  含税金额，必填，最大长度18位，最多2位小数。  
$\bullet$  扣除额，选填，最大长度18位，最多2位小数。  
$\bullet$  商品和服务税收分类合并编码，必填，最大长度19位。必须在商品编码信息中存在。  
$\bullet$  发票行性质, 必填, 取值范围为 “ 00 ”、 “ 01 ”、 “ 02 ”。  
- 优惠政策标识，选填，不为空时取值范围为“01”、“02”、“03”、“04”、“05”、“06”、“07”、“08”、“09”、“10”、“11”、“12”、“13”、“14”、“15”、“16”、

“17”、“18”。

● 附加要素名称，选填，最大长度200位。  
$\bullet$  附加要素类型，选填，最大长度200位。  
$\bullet$  附加要素值，选填，最大长度200位。  
$\bullet$  序号，必须为空。  
$\bullet$  凭证类型，必须为空。  
$\bullet$  发票代码，必须为空。  
$\bullet$  发票号码，必须为空。  
差额凭证号码，必须为空。  
$\bullet$  开具日期，必须为空。  
●凭证合计金额，必须为空。  
●本次扣除金额，必须为空。  
$\bullet$  备注，必须为空。

# 3.3.2.4.2数据校验

- 红字发票明细和红字确认单必须保持一致  
- 当红字确认单“蓝字发票特定要素类型代码”为“20”时，红字发票“特定要素”传空，开具具有农产品编码且税率不为13%的红字数电专票时，发票上传后将被标注为农产品专票，特定要素为20。  
●开具红字发票时，差额扣除清单必须为空。  
- 开具红字发票时，差额征税类型、优惠政策标识必须与蓝字发票一致，扣除额必须为蓝票扣除额的负数。  
● 发票上传时间与开票时间间隔应当小于48小时。

# 3.3.2.5校验发票额度

判断红字发票对应蓝字发票的开票日期，若红字发票对应蓝字发票的开票日期为当前月份，需要增加本地发票额度，增加的数量为红字发票开票金额；若红字发票对应的蓝字发票的开票日期不是当前月份，不增加本地发票额度。

# 3.3.2.6发票赋码

从本地数电票号码段中给要开具的数电票依次分配不重复的数电票号码，若本地数电票号码已使用完毕，调用操作。

# 3.3.2.7发票上传

发票赋码成功后，首先在本地保存数电红字发票预开具信息（发票状态为“预开具成功”），调用税务局端《数电票上传》接口预上传数电红字发票，并依据返回的结果，更新本地发票预上传结果，具体参见“四、接口列表10.数电票上传”。

# 3.3.2.8查询发票上传结果

发票上传成功后，间隔10秒-10分钟依据发票上传返回的“受理流水号”调用税务局端《查询数电票上传结果》接口查询数电红字发票是否接收成功，并依据返回的发票开具结果，更新本地发票开具结果，具体参见“四、接口列表12.查询数电票上传结果”。

# 4开票汇总确认

# 4.1.全流程图

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-30/fcc96c6c-7c35-4d97-9baa-3a4ec13ee8ae/02c00277f1e01c35b0378ea42451c637f3dc57bab7549314b6dd2abc04bfebe5.jpg)  
业务流程图

# 4.2.业务规则

# 4.2.1数电票汇总信息上传

给企业提供按月上传发票汇总信息接口，以避免由于企业未及时上传发票而带来的问题。企业在每月13日前需按自然月汇总上月在本平台开具的数电票的数量、金额和税额上传至乐企服务端，与乐企服务端汇总接收到的数电票信息进行比对，若比对一致，返回比对成功；若比对不一致，返回具体失败信息，由企业核实后，再次上传。开票汇总确认后不允许上传已确认的月份的数字化电子发票说明。具体参见“四、接口列表15.上传发票汇总确认信息”。

若企业在每月13日前未上传上个月的发票汇总确认信息，乐企服务端将在13日零点汇总乐企服务端接收到的上个月的数子化电子发票。每月13日零点之后，上个月未上传的发票，请重新开具。

每月13日之前，当企业上传发票汇总确认信息后，发现已确认的月份还有数电票未上传，可以取消发票汇总确认，把未上传的数电票上传至乐企服务端后再次上传发票汇总确认信息。

# 4.2.2查询发票汇总确认信息

给企业提供发票汇总确认信息查询功能，企业可以通过此接口查询历史发票汇总确认信息，具

# 四、接口列表

# （一）接口清单

<table><tr><td>序号</td><td>接口名称</td><td>服务编码</td></tr><tr><td>1</td><td>获取数电票批量预赋码信息</td><td>QDFPPLFM</td></tr><tr><td>2</td><td>查询发票额度</td><td>CXSXED</td></tr><tr><td>3</td><td>下载/退回发票额度</td><td>XZTHSXED</td></tr><tr><td>4</td><td>调整发票额度有效期</td><td>TZSXEDYXQ</td></tr><tr><td>5</td><td>查询纳税人风险信息</td><td>CXNSRFXXX</td></tr><tr><td>6</td><td>查询纳税人基本信息</td><td>CXNSRJBXX</td></tr><tr><td>7</td><td>查询可用税率信息</td><td>CXYKYSL</td></tr><tr><td>8</td><td>查询税收分类编码信息</td><td>CXSSFLBM</td></tr><tr><td>9</td><td>查询数电红字确认单列表信息</td><td>CXQDHZQRDLB</td></tr><tr><td>10</td><td>查询数电红字确认单明细信息</td><td>CXQDHZQRDMX</td></tr><tr><td>11</td><td>数电票上传</td><td>QDFPSC</td></tr><tr><td>12</td><td>查询数电票上传结果</td><td>CXQDFPSCJG</td></tr><tr><td>13</td><td>数电红字确认单申请</td><td>QDHZQRDSQ</td></tr><tr><td>14</td><td>数电红字确认单确认</td><td>QDHZQRDQR</td></tr><tr><td>15</td><td>上传发票汇总确认信息</td><td>SCFPHZQRXX</td></tr><tr><td>16</td><td>查询发票汇总确认信息</td><td>CXFPHZQRXX</td></tr><tr><td>17</td><td>查询差额征税编码</td><td>CXCEZSBM</td></tr></table>

调用地址：https://lqpt.chinatax.gov.cn:8443/access/v2/invoke/能力编码/接口编码/

调用说明：

```javascript
try {  
String encbody = SM4Util encryptEcb(秘钥, body); // 对请求报文加密  
HttpHeaders headers = new HttpHeaders();  
headers.add("fwbm","")); // 添加服务编码  
headers.add("jrdwptbh","")); // 添加接入单位平台编号  
headers.add("sydwptbh","")); // 添加使用单位平台编号  
headers.add("nlbm","")); // 添加能力编码
```

```groovy
headers.add("ylbm",": //添加用例编码  
headers.add("access_signature",": //添加访问签名  
headers.add("sxcsbz",": //添加沙箱测试标志  
String result = null; //接收税局相应报文（未解密）  
GZIPInputStream gzip = null; //商品服务编码返回时为gzip压缩格式  
BufferedReader reader = null;  
StringWriter writer = null;  
try {  
HttpEntity<String> entity = new HttpEntity<> (encbody, headers);  
//向税局发送请求  
ResponseEntity<byte[]> responseEntity = restTemplate.postForEntity(税局端地址, entity, byte[].class);  
//解析税局返回内容  
List<String> valuesAsList = responseEntity.getHeaders().getValuesAsList("content-encoding");  
//如果返回gzip时处理  
if (!CollectionUtil.isEmpty(valuesAsList) && valuesAsList.contains("gzip")){  
gzip = new GZIPInputStream(new ByteArrayInputStream(responseEntity.Body()));  
reader = new BufferedReader(new InputStreamReader(gzip));  
writer = new StringWriter();  
String line;  
while ((line = reader.ReadLine()) != null) {  
writer.write(line);  
}  
result = writer.toString();  
}else{//返回非gzip时处理  
result = new String(responseEntity.Body(), StandardCharrsets.UTF_8);  
}  
}finally {
```

```javascript
if(Object.nonNull(gzip)){IOUtilsl.closeQuietly(gzip);}if(Object.nonNull(reader)){IOUtilsl.closeQuietly(reader);}if(Object.nonNull写道er)){IOUtilsl.closeQuietly写道er);}if(Object.nonNull写道er)){IOUtilsl.closeQuietly写道er);}1og.info("能力开放平台响应报文{}",result);KfptRes<String> kfptRes = objectMapper.readValue(result,tr1);/\*\* \*如果返回不是200或没有error节点则无需解密\*/if(!"200".equals(kfptRes"httpStatusCode())){return kfptRes;1ServerResponse<String> serverResponse  $=$  objectMapper.readValue(kfptRes.Body(),tr2);Error error  $=$  serverResponse/response().getError();if(Object.nonNull(error)){return kfptRes;1//解密返回报文String data  $=$  serverResponse/response().的数据();String decdata  $=$  SM4Util.decryptEcb(秘钥,data);serverResponse RESPONSE().setData(decdata);
```

```typescript
KfptRes<ServerResponse<String>> success = new KfptRes<>(); success.setHttpStatusCode(kfptRes.getHttpStatusCode()); success.setBody(serverResponse); //成功处理 } catch (Exception e) { log.info(""); //异常处理 }
```

字段说明：税率在各个接口中有不同数据项标识，但是意义相同。

<table><tr><td>字段</td><td>数据项标识</td></tr><tr><td>税率</td><td>sl1,slv,zzssl,zsl,slzsl</td></tr></table>

# 获取数电票批量预赋码信息

# 1.1接口说明

向纳税人提供批量预赋码功能，用于企业给数电票自动赋发票号码。

企业使用开票前置判断企业发票库存低于“  $20\%$  ”阈值时，调用此接口申请预分配新号码段。

数电票号码前2位代表使用年份，禁止跨年度使用。例如：“22”开头的发票号码为2022年度的发票号码，只能在2022年使用，开票日期必须为2022年。企业在2022年开具的数电票，可以在跨年后继续上传，跨年后企业需要重新下载新一年度的数电票号码开具数电票。

企业每次获取数电票批量预赋码信息时，需要上传业务流水号，由“使用单位id”+“直连单位id”+“32位随机生成码”组成，若企业由于网络超时等原因没有收到获取结果，可以通过该业务流水号重新请求，重新请求时领用数量需要保持不变。

注意：每次最多申请5000份数电票。

# 1.2请求参数

<table><tr><td>序号</td><td>数据项标识</td><td>数据项名称</td><td>字段类型</td><td>长度</td><td>必须</td><td>说明</td></tr><tr><td>1</td><td>nsrsbh</td><td>纳税人识别号/统一社会信用代码</td><td>varchar</td><td>20</td><td>是</td><td>申领发票的纳税人识别号或统一社会信用代码</td></tr><tr><td>2</td><td>lysl</td><td>领用数量</td><td>number</td><td>10</td><td>是</td><td>申领数量最大值为：5000</td></tr><tr><td>3</td><td>ywlsh</td><td>业务流水号</td><td>varchar</td><td>100</td><td>是</td><td>“使用单位id”+“直连单位id”+“32位随机生成数”</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr></table>

# 1.3请求报文示例

```json
{ "nsrsbh":"纳税人识别号/统一社会信用代码", "lysl":"领用数量", "ywlsh":"业务流水号" }
```

# 1.4返回参数

<table><tr><td>序号</td><td>数据项标识</td><td>数据项名称</td><td>字段类型</td><td>长度</td><td>必须</td><td>说明</td></tr><tr><td>1</td><td>returncode</td><td>返回码</td><td>varchar</td><td>2</td><td>是</td><td>00: 成功
其它: 失败</td></tr><tr><td>2</td><td>returnmsg</td><td>返回信息</td><td>varchar</td><td>2000</td><td>否</td><td>错误信息说明</td></tr><tr><td>3</td><td>fpqshm</td><td>发票起始号码</td><td>varchar</td><td>20</td><td>是</td><td></td></tr><tr><td>4</td><td>fpzzhm</td><td>发票终止号码</td><td>varchar</td><td>20</td><td>是</td><td></td></tr><tr><td>5</td><td>lysl</td><td>领用数量</td><td>number</td><td>10</td><td>是</td><td></td></tr></table>

# 1.5返回报文示例

成功返回：

```json
{
"Response":{ "RequestId":"16位随机数字和字母组合",
"Data":{ "returncode":"00",
"returnsmsg":"成功",
"fpqshm":"发票起始号码",
"fpzzhm":"发票终止号码",
"lysl":"领用数量"
}
}
```

失败返回：

```json
{ "Response":{ "RequestId":"16位随机数字和字母组合", "Error":{ "Code":"01"， "Message":"错误说明" } } }
```

# 2.查询发票额度

# 2.1接口说明

向纳税人提供发票额度查询功能，可查询企业当前在税务局端的发票额度信息，包括：暂停赋额标志、本月发票额度、可用剩余额度、已下载额度、已下载未使用额度、属期。

当纳税人为按需开票企业时，查询发票额度时，本月发票额度及剩余可用额度均为9999999999999999，但纳税人仍需正常下载发票额度进行开票使用，纳税人发票上传后剩余可用额度不变，仍为999999999999999。

注意：查询授信额度有时间间隔，最小时间间隔为一个小时。请企业根据企业自身业务情况，合理安排分配查询授信额度时间。

# 2.2请求参数

<table><tr><td>序号</td><td>数据项标识</td><td>数据项名称</td><td>字段类型</td><td>长度</td><td>必须</td><td>说明</td></tr><tr><td>1</td><td>nsrsbh</td><td>纳税人识别号/统一社会信用代码</td><td>varchar</td><td>20</td><td>是</td><td>申领发票的纳税人识别号或统一社会信用代码</td></tr></table>

# 2.3请求报文示例

```json
{"nsrsbh": "纳税人识别号/统一社会信用代码"}
```

# 2.4返回参数

<table><tr><td>序号</td><td>数据项标识</td><td>数据项名称</td><td>字段类型</td><td>长度</td><td>必须</td><td>说明</td></tr><tr><td>1</td><td>returncode</td><td>返回码</td><td>varchar</td><td>2</td><td>是</td><td>00:成功</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td>其它:失败</td></tr><tr><td>2</td><td>returnmsg</td><td>返回信息</td><td>varchar</td><td>2000</td><td>否</td><td>错误信息说明</td></tr><tr><td>3</td><td>ztsxbz</td><td>暂停赋额标志</td><td>varchar</td><td>2</td><td>是</td><td>Y:暂停
N:未暂停</td></tr><tr><td>4</td><td>bysxed</td><td>本月发票额度</td><td>number</td><td>18,2</td><td>是</td><td>本月总发票额度</td></tr><tr><td>5</td><td>kysyed</td><td>可用剩余额度</td><td>number</td><td>18,2</td><td>是</td><td>本月可用发票额度</td></tr><tr><td>6</td><td>yxzed</td><td>已下载额度</td><td>number</td><td>18,2</td><td>是</td><td>本月乐企1.5已下载的全部发票额度</td></tr><tr><td>7</td><td>yxzwsyed</td><td>已下载未使用额度</td><td>number</td><td>18,2</td><td>是</td><td>本月乐企1.5已下载的全部发票额度减已上传的开票日期为本月的发票的总金额</td></tr><tr><td>8</td><td>sq</td><td>属期</td><td>varchar</td><td>6</td><td>是</td><td>格式: yyyyMMdd</td></tr></table>

# 2.5返回报文示例

成功返回：

```json
{ "Response":{ "RequestId":"16位随机数字和字母组合", "Data":{ "returncode":"00", "returnsmsg":"成功", "ztsxbz":"暂停赋额标志", "bysxed":"本月发票额度", "kysyed":"可用剩余额度", "yxzed":"已下载额度", "yxzwsyed":"已下载未使用额度", "sq":"属期" } } }
```

失败返回：

```json
{
"Response":{ "RequestId":"16位随机数字和字母组合",
"Error":{ "Code":"01",
"Message":"错误说明"
}
}
```

# 3.下载/退回发票额度

# 3.1接口说明

向纳税人提供下载/退回发票额度功能，企业可通过接口从税务局端下载或退回发票额度。

# 1、下载发票额度

当企业本地的已下载未使用的发票额度小于需要开具的数电票的额度时，可通过此接口下载发票额度。

建议根据企业自身开票情况，对本地已下载未使用的发票额度设置阈值，当已下载未使用的发票额度小于设置的阈值时，自动触发下载发票额度操作。

# 2、退回发票额度

当企业需要在其他平台开具数电票，但是发票额度不足时，企业可通过此接口把下载到本地的发票额度退回至税务局端，以便企业在其他平台开具数电票时。

发票额度即开票额度，用于控制企业开具数电票的总额度，乐企1.5要求企业自行管理每月数电票的发票额度，以下情况禁止使用发票额度。

$\bullet$  发票额度不在有效期内  
$\bullet$  跨月使用  
$\bullet$  开票总额度大于发票额度

企业每次下载/退回发票额度时，需要上传业务流水号，由“使用单位id”+“直连单位id”+“32位随机生成码”组成，若企业由于网络超时等原因没有收到发票额度下载/退回结果，可以通过该业务流水号重新获取，使用相同业务流水号申请下载/退回发票额度时申请类型与申请额度需要相同。

# 3.2请求参数

<table><tr><td>序号</td><td>数据项标识</td><td>数据项名称</td><td>字段类型</td><td>长度</td><td>必须</td><td>说明</td></tr><tr><td>1</td><td>nsrsbh</td><td>纳税人识别号/统一社会信用代码</td><td>varchar</td><td>20</td><td>是</td><td>申领发票的纳税人识别号或统一社会信用代码</td></tr><tr><td>2</td><td>ptbh</td><td>平台编号</td><td>varchar</td><td>20</td><td>是</td><td></td></tr><tr><td>3</td><td>sqlx</td><td>申请类型</td><td>varchar</td><td>2</td><td>是</td><td>0:下载
1:退回</td></tr><tr><td>4</td><td>sqed</td><td>申请额度</td><td>number</td><td>20,2</td><td>是</td><td></td></tr><tr><td>5</td><td>ywlsh</td><td>业务流水号</td><td>varchar</td><td>100</td><td>是</td><td>“使用单位id”+“直连单位id”+“32位随机生成数”</td></tr></table>

# 3.3请求报文示例

```txt
{ "nsrsbh": "纳税人识别号/统一社会信用代码", "ptbh": "平台编号", "sqlx": "申请类型", "sqed": "申请额度", "ywlsh": "业务流水号" }
```

# 3.4返回参数

<table><tr><td>序号</td><td>数据项标识</td><td>数据项名称</td><td>字段类型</td><td>长度</td><td>必须</td><td>说明</td></tr><tr><td>1</td><td>returncode</td><td>返回码</td><td>varchar</td><td>2</td><td>是</td><td>00:成功
其它:失败</td></tr><tr><td>2</td><td>returnmsg</td><td>返回信息</td><td>varchar</td><td>2000</td><td>否</td><td>错误信息说明</td></tr><tr><td>3</td><td>syqjq</td><td>发票额度使用区间起</td><td>date</td><td></td><td>否</td><td>下载发票额度时,有此节点
数电票开票日期在发票额度使用区间(含)时才可以使用.格式:yyyymmdd</td></tr><tr><td>4</td><td>syqjz</td><td>发票额度使用区间止</td><td>date</td><td></td><td>否</td><td>下载发票额度时,有此节点
数电票开票日期在发票额度使用区间(含)时才可以使用.格式:yyyymmdd</td></tr></table>

# 3.5返回报文示例

成功返回：

```json
{ "Response":{ "RequestId":"16位随机数字和字母组合", "Data":{ "returncode":"00", "returnmsg":"成功", "syqjq":"发票额度使用区间起", "syqjz":"发票额度使用区间止" } } }
```

失败返回：

```json
{
"Response":{ "RequestId":"16位随机数字和字母组合", "Error":{ "Code":"01"， "Message":"错误说明"
}
```

# 4.调整发票额度有效期

4.2请求参数

<table><tr><td>序号</td><td>数据项标识</td><td>数据项名称</td><td>字段类型</td><td>长度</td><td>必须</td><td>说明</td></tr><tr><td>1</td><td>xsfnsrsbh</td><td>统一社会信用代码/纳税人识别号/身份证号码</td><td>varchar</td><td>20</td><td>是</td><td></td></tr><tr><td>2</td><td>sxedsq</td><td>发票额度属期</td><td>varchar</td><td>7</td><td>是</td><td>格式：yyyyMMdd</td></tr></table>

# 4.1接口说明

给企业提供调整发票额度有效期接口，企业在月初未申报时下载的发票额度的有效期止为当月申报截止日期，超过发票额度有效期止后，无法开具数电票，企业在完成申报或到达发票额度有效期止后，通过此接口调整发票额度有效期，并根据税局端返回的有效期更新本地发票额度有效期。

# 4.3请求报文示例

```json
{ "xsfnsrsbh":"（销售方）统一社会信用代码/纳税人识别号/身份证件号码", "sxedsq":"发票额度属期" }
```

# 4.4返回参数

<table><tr><td>序号</td><td>数据项标识</td><td>数据项名称</td><td>字段类型</td><td>长度</td><td>必须</td><td>说明</td></tr><tr><td>1</td><td>returncode</td><td>返回码</td><td>varchar</td><td>2</td><td>是</td><td>00:成功
其它:失败</td></tr><tr><td>2</td><td>returnmsg</td><td>返回信息</td><td>varchar</td><td>2000</td><td>否</td><td>错误信息说明</td></tr><tr><td>3</td><td>sxedsq</td><td>发票额度属期</td><td>varchar</td><td>7</td><td>是</td><td>格式: yyyy-MM</td></tr><tr><td>4</td><td>syqjq</td><td>发票额度使用区间起</td><td>date</td><td></td><td>否</td><td>下载发票额度时,有此节点
数电票开票日期在发票额度使用区间(含)时才可以使用.格式: yyyyMMdd</td></tr><tr><td>5</td><td>syqjz</td><td>发票额度使用区间止</td><td>date</td><td></td><td>否</td><td>下载发票额度时,有此节点
数电票开票日期在发票额度使用区间(含)时才可以使用.格式: yyyyMMdd</td></tr></table>

# 4.5返回报文示例

成功时返回：

```txt
{ "Response":{ "RequestId":"16位随机数字和字母组合", "Data": {
```

```json
"returncode":"00", "returnsq":"成功", "sxedsq":"发票额度属期", "syqqq":"发票额度使用区间起" "syqjz":"发票额度使用区间止" } } }
```

失败返回：

```json
{ "Response":{ "RequestId":"16位随机数字和字母组合", "Error":{ "Code":"01”， "Message":"错误说明" } } 1
```

# 5.查询纳税人风险信息

# 5.1接口说明

向企业提供查询纳税人风险信息的功能，企业可将查询的风险信息保存在本地。在开票时自校验该接口获取的风险信息是否满足开具发票的条件，控制高风险企业操作涉税业务。建议企业每24小时通过调用该接口更新本地风险信息。

# 5.2请求参数

<table><tr><td>序号</td><td>数据项标识</td><td>数据项名称</td><td>字段类型</td><td>长度</td><td>必须</td><td>说明</td></tr><tr><td>1</td><td>nsrsbh</td><td>纳税人识别号/统一社会信用代码</td><td>varchar</td><td>20</td><td>是</td><td>开票纳税人识别号/统一社会信用代码</td></tr></table>

# 5.3请求报文示例

```txt
{
```

```json
"nsrsbh": "纳税人识别号/统一社会信用代码"  
}
```

5.4返回参数  

<table><tr><td>序号</td><td>数据项标识</td><td>数据项名称</td><td>字段类型</td><td>长度</td><td>必须</td><td>说明</td></tr><tr><td>1</td><td>returncode</td><td>返回码</td><td>varchar</td><td>2</td><td>是</td><td>00:成功
其它:失败</td></tr><tr><td>2</td><td>returnmsg</td><td>返回信息</td><td>varchar</td><td>2000</td><td>否</td><td>错误信息说明</td></tr><tr><td>3</td><td>nsrsbh</td><td>纳税人识别号/统一社会信用代码</td><td>varchar</td><td>20</td><td>是</td><td></td></tr><tr><td>4</td><td>fxnsrlx</td><td>风险纳税人类型</td><td>varchar</td><td>2</td><td>否</td><td>空:非风险纳税人
01:I类(高风险)纳税人
02:II类(中风险)纳税人
03:III类(低风险)纳税人
04:IV类(无风险)纳税人</td></tr><tr><td>5</td><td>nsrxydj</td><td>纳税人信用等级</td><td>varchar</td><td>20</td><td>是</td><td>A
B
C
D
M</td></tr><tr><td>6</td><td>nsryjjb</td><td>纳税人预警级别</td><td>varchar</td><td>1</td><td>否</td><td>空:无预警
01:红色预警
02:黄色预警
03:蓝色预警</td></tr><tr><td>7</td><td>fxnsrbz</td><td>风险纳税人标志</td><td>varchar</td><td>1</td><td>是</td><td>Y:风险纳税人
N:正常纳税人</td></tr></table>

# 5.5返回报文示例

成功返回：

```txt
{ "Response":{
```

失败返回：  
```json
"RequestId": "16位随机数字和字母组合",  
"Data": {  
    "returncode": "00",  
    "returnmsg": "成功",  
    "nsrsbh": "纳税人识别号/统一社会信用代码",  
    "fxnsrlx": "风险纳税人类型",  
    "nsrxydj": "纳税人信用等级",  
    "nsryjjb": "纳税人预警级别",  
    "fxnsrbz": "风险纳税人标志"  
}  
}
```

```json
{ "Response":{ "RequestId":"16位随机数字和字母组合", "Error":{ "Code":"01"， "Message":"错误说明" } } }
```

# 6.查询纳税人基本信息

# 6.1接口说明

向企业提供查询纳税人基本信息的功能，企业可将查询的基本信息，包括生产经营信息、税务机关信息、企业性质、消费税性质等保存在本地。在开票时自校验该接口获取的纳税人基本信息是否满足开具发票的条件。

建议定时获取纳税人基本信息，或者在纳税人基本信息发生变更时手动触发更新。

# 6.2请求参数

<table><tr><td>序号</td><td>数据项标识</td><td>数据项名称</td><td>字段类型</td><td>长度</td><td>必须</td><td>说明</td></tr><tr><td>1</td><td>nsrsbh</td><td>纳税人识别号/统一社会信用代码</td><td>varchar</td><td>20</td><td>是</td><td>开票纳税人识别号/统一社会信用代码</td></tr></table>

# 6.3请求报文示例

"nsrsbh": "纳税人识别号/统一社会信用代码"

}

# 6.4返回参数

<table><tr><td>序号</td><td>数据项标识</td><td>数据项名称</td><td>字段类型</td><td>长度</td><td>必须</td><td>说明</td></tr><tr><td>1</td><td>returncode</td><td>返回码</td><td>varchar</td><td>2</td><td>是</td><td>00:成功
其它:失败</td></tr><tr><td>2</td><td>returnmsg</td><td>返回信息</td><td>varchar</td><td>2000</td><td>否</td><td>错误信息说明</td></tr><tr><td>3</td><td>nsrsbh</td><td>纳税人识别号/统一社会信用代码</td><td>varchar</td><td>20</td><td>是</td><td></td></tr><tr><td>4</td><td>djxh</td><td>登记序号</td><td>varchar</td><td>20</td><td>否</td><td></td></tr><tr><td>5</td><td>ssdabh</td><td>税收档案编号</td><td>varchar</td><td>20</td><td>否</td><td></td></tr><tr><td>6</td><td>nsrmc</td><td>纳税人名称</td><td>varchar</td><td>300</td><td>是</td><td></td></tr><tr><td>7</td><td>nsrlx</td><td>纳税人类型标签</td><td>varchar</td><td>300</td><td>是</td><td>1:一般纳税人
2:小规模纳税人
3:转登记小规模纳税人
4:辅导期一般纳税人
5:自然人</td></tr><tr><td>8</td><td>scjydz</td><td>生产经营地址</td><td>varchar</td><td>300</td><td>是</td><td></td></tr><tr><td>9</td><td>zcdyzbm</td><td>注册地邮政编码</td><td>varchar</td><td>6</td><td>是</td><td></td></tr><tr><td>10</td><td>zcdlxdh</td><td>注册地联系电话</td><td>varchar</td><td>60</td><td>否</td><td></td></tr><tr><td>11</td><td>fddbrxm</td><td>法人名称(法定代表人姓名</td><td>varchar</td><td>150</td><td>是</td><td></td></tr><tr><td>12</td><td>djzclxdm</td><td>登记注册类型(国标)</td><td>varchar</td><td>3</td><td>否</td><td></td></tr><tr><td>13</td><td>hydm</td><td>行业代码</td><td>varchar</td><td>4</td><td>是</td><td>主行业代码特定征收部门可空</td></tr><tr><td>14</td><td>qxjswjgdm</td><td>区县级税务机关代码</td><td>varchar</td><td>11</td><td>是</td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>15</td><td>zgswskfjdm</td><td>税务机关代码</td><td>varchar</td><td>11</td><td>是</td><td>主管税务所科分局</td></tr><tr><td>16</td><td>zgswskfjmc</td><td>税务机关名称</td><td>varchar</td><td>300</td><td>是</td><td>主管税务所科分局</td></tr><tr><td>17</td><td>cwfzrxm</td><td>财务负责人姓名</td><td>varchar</td><td>150</td><td>是</td><td></td></tr><tr><td>18</td><td>khhmc</td><td>账户名称</td><td>varchar</td><td>300</td><td>是</td><td></td></tr><tr><td>19</td><td>yhzh</td><td>账号</td><td>varchar</td><td>50</td><td>否</td><td>首选账户账号</td></tr><tr><td>20</td><td>bsrxm</td><td>企业办税人员姓名</td><td>varchar</td><td>150</td><td>否</td><td></td></tr><tr><td>21</td><td>xdpsdqybz</td><td>数电票试点企业标识</td><td>varchar</td><td>20</td><td>是</td><td>Y: 数电票试点企业
N: 不是数电票试点企业</td></tr><tr><td>22</td><td>ckqyfldm</td><td>出口企业分类</td><td>varchar</td><td>20</td><td>是</td><td>空: 非出口企业
01: 一类出口企业
02: 二类出口企业
03: 三类出口企业
04: 四类出口企业</td></tr><tr><td>23</td><td>zfjglxdm</td><td>总分机构类型</td><td>varchar</td><td>20</td><td>是</td><td>0: 非总分机构
1: 总机构
2: 分支机构
3: 分总机构</td></tr><tr><td>24</td><td>yhyywddm</td><td>银行营业网点</td><td>varchar</td><td>13</td><td>否</td><td></td></tr><tr><td>25</td><td>nsrztdm</td><td>开票方纳税人状态</td><td>varchar</td><td>2</td><td>是</td><td>01: 受理
02: 筹建期
03: 正常
04: 停业
05: 非正常
06: 清算
07: 注销
08: 非正常户注销
09: 报验</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td>10:核销报验
11:中断缴费
12:恢复缴费
13:简易注销无异议
99:其他</td></tr><tr><td>26</td><td>yxqq</td><td>纳税人类型标签有效期起</td><td>date</td><td></td><td>否</td><td>格式: yyyy-MM-dd</td></tr><tr><td>27</td><td>yxqz</td><td>纳税人类型标签有效期止</td><td>date</td><td></td><td>否</td><td>格式: yyyy-MM-dd</td></tr><tr><td>28</td><td>qyhyxzdm</td><td>企业行业性质</td><td>varchar</td><td>300</td><td>否</td><td>01:成品油生产企业
02:成品油经销企业
03:国内机动车生产企业
04:进口机动车生产企业驻我国办事处或总授权代理机构
05:机动车授权经营企业
06:其他机动车贸易商
07:二手车市场
08:二手车经销企业
09:二手车拍卖企业
10:稀土矿产企业
11:稀土冶炼分离企业
12:稀土其他企业
13:稀土矿产企业、稀土冶炼分离企业、稀土其他企业</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td>14:稀土矿产企业、稀土冶炼分离企业 15:稀土矿产企业、稀土其他企业</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td>16:稀土冶炼分离企业、稀土其他企业</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td>17:卷烟生产企业</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td>18:卷烟批发企业</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td>19:卷烟出口企业</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td>20:生产型出口企业</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td>21:外贸型出口企业</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td>22:外贸综合服务企业</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td>23:自贸区试点企业</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td>24:特殊监管区内企业</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td>25:增值税一般纳税人资格试点</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td>26:市场采购试点</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td>27:退税商店</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td>28:电子商务出口企业</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td>29:享受出口退税政策的融资租赁企业</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td>30:增值税税率应税服务提供者</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td>31:房地产开发企业</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td>32:农产品深加工企业</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td>33:外购石脑油、燃料油用于消</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td>费税退税企业34:从事机动车进口的其他贸易商35:自产农产品者36:农产品收购企业37:光伏收购企业38:住房租赁企业39:冬奥会退税企业</td></tr><tr><td>29</td><td>xfsnsrlxdm</td><td>消费税纳税人类型</td><td>varchar</td><td>20</td><td>否</td><td>01:卷烟生产消费税纳税人02:卷烟批发消费税纳税人03:白酒生产消费税纳税人04:黄酒生产消费税纳税人05:啤酒生产消费税纳税人06:其他酒生产消费税纳税人07:小汽车生产消费税纳税人08:超豪华小汽车消费税纳税人09:汽油生产消费税纳税人10:石脑油生产消费税纳税人11:溶剂油生产消费税纳税人12:润滑油生产消费税纳税人13:柴油生产消费税纳税人14:航空煤油生</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td>产消费税纳税人
15:燃料油生产消费税纳税人
16:电池生产消费税纳税人
17:涂料生产消费税纳税人
18:高档化妆品生产消费税纳税人
19:金银首饰铂金首饰和钻石及钻石饰品零售消费税纳税人
20:其他贵重首饰和珠宝玉石生产消费税纳税人
21:鞭炮焰火生产消费税纳税人
22:摩托车生产消费税纳税人
23:高尔夫球及球具生产消费税纳税人
24:高档手表生产消费税纳税人
25:游艇生产消费税纳税人
26:木制一次性筷子生产消费税纳税人
27:实木地板生产消费税纳税人
28:雪茄烟生产消费税纳税人
29:烟丝生产消费税纳税人</td></tr></table>

# 6.5返回报文示例

成功返回：

```txt
{ "Response":\{\}
```

"RequestId":"16位随机数字和字母组合",

"Data":{

"returncode": "00",

"returnmsg": "成功",

"jcxx": {

"nsrsbh": "纳税人识别号/统一社会信用代码",

"dxh": "登记序号",

"ssdabh": "税收档案编号",

"nsrmc": "纳税人名称",

"nsrlx": "纳税人类型",

"scjydz": "生产经营地址",

"zcdyzbm": "注册地邮政编码",

"zcdlxdh": "注册地联系电话",

"fddbrxm": "法人名称(法定代表人姓名)",

"dzclxdm": "登记注册类型（国标）",

"hydm": "行业代码",

"qxjswjgdm": "区县级税务机关代码",

"zgswskfjdm": "税务机关代码",

"zgswskfjmc": "税务机关名称",

"cfzrxm": "财务负责人姓名",

"khhhmc": "账户名称",

"yhzh": "账号",

"bsrxm": "企业办税人员姓名",

"xdpsdqyz": "数电票试点企业标识",

"ckqyfldm": "出口企业分类",

"zfjglxdm": "总分机构类型",

"yhyywddm": "银行营业网点",

"nsrztdm": "开票方纳税人状态",

"yxqq": "有效期起",

失败返回：  
```json
"yxqz":"有效期止"  
},  
"qyhyxzGrid":[  
{  
"qyhyxzdm":"企业行业性质",  
"yxqq":"有效期起",  
"yxqz":"有效期止"  
}  
],  
"xfsnsrlxGrid":[  
{  
"xfsnsrlxdm":"消费税纳税人类型",  
"yxqq":"有效期起",  
"yxqz":"有效期止"  
}  
]  
}  
}
```

```json
{ "Response":{ "RequestId":"16位随机数字和字母组合", "Error":{ "Code":"01”， "Message":"错误说明" } } 1
```

# 7.查询可用税率信息

# 7.1接口说明

向企业提供查询可用税率信息的功能，企业可将查询的基本信息保存在本地。在开票时选择保存在本地的可用税率。

建议定时获取可用税率。

# 7.2请求参数

无

# 7.3请求报文示例

<table><tr><td>{}</td></tr></table>

# 7.4返回参数

<table><tr><td>序号</td><td>数据项标识</td><td>数据项名称</td><td>字段类型</td><td>长度</td><td>必须</td><td>说明</td></tr><tr><td>1</td><td>returncode</td><td>返回码</td><td>varchar</td><td>2</td><td>是</td><td>00:成功
其它:失败</td></tr><tr><td>2</td><td>returnmsg</td><td>返回信息</td><td>varchar</td><td>2000</td><td>否</td><td>错误信息说明</td></tr><tr><td>3</td><td>count</td><td>总数量</td><td>number</td><td>10</td><td>是</td><td></td></tr><tr><td>4</td><td>csxz</td><td>参数性质</td><td>varchar</td><td>2</td><td>是</td><td>1:税率
2:征收率</td></tr><tr><td>5</td><td>slzsl</td><td>税率征收率</td><td>number</td><td>16,6</td><td>是</td><td></td></tr><tr><td>6</td><td>yslbz</td><td>原税率标志</td><td>varchar</td><td>1</td><td>是</td><td>Y:是原税率
N:非原税率</td></tr><tr><td>7</td><td>dyysl</td><td>对应原税率</td><td>varchar</td><td>150</td><td>否</td><td>百分比形式、逗号连接</td></tr><tr><td>8</td><td>cszt</td><td>参数状态</td><td>varchar</td><td>1</td><td>是</td><td>0:启用
1:停用</td></tr><tr><td>9</td><td>yxqq</td><td>有效期起</td><td>date</td><td></td><td>是</td><td>时间格式:
yyyy-MM-dd</td></tr><tr><td>10</td><td>yxqz</td><td>有效期止</td><td>date</td><td></td><td>否</td><td>时间格式:
yyyy-MM-dd</td></tr><tr><td>11</td><td>tyrq</td><td>停用日期</td><td>date</td><td></td><td>否</td><td>时间格式:
yyyy-MM-dd</td></tr></table>

# 7.5返回报文示例

# 成功返回：

```json
{
"Response": {
"RequestId": "16位随机数字和字母组合",
"Data": {
"returncode": "00",
"returnsmsg": "成功",
"count": "总数量",
"szlist": [ \{
"csxz": "参数性质",
"szsl": "税率征收率",
"yslbz": "原税率标志",
"dyysl": "对应原税率",
"czt": "参数状态",
"yxqq": "有效期起",
"yxqz": "有效期止",
'tyrq': "停用日期"
\}
\}
\}
\}
```

# 失败返回：

```json
{
"Response":{ "RequestId": "16位随机数字和字母组合", "Error":{ "Code": "01"，
```

```txt
"Message": "错误说明"  
}  
}  
}
```

# 8.查询税收分类编码信息

# 8.1接口说明

向企业提供查询商品税收分类编码信息的功能，企业可将查询的编码信息保存在本地。在开票时选择保存在本地的税收分类编码。

建议定时获取税收分类编码。

针对不同的税收分类编码维护了可使用增值税特殊管理内容，即可使用的优惠政策，纳税人在开具数电票时可以根据选择的税收分类编码选择适用的优惠政策，享受税收减免政策。

增值税特殊管理共分为18类，分别是“简易征收”“稀土产品”“免税”“不征税”“先征后退”“100%先征后退”“50%先征后退”“按3%简易征收”“按5%简易征收”“按5%简易征收减按1.5%计征”“即征即退30%”“即征即退50%”“即征即退70%”“即征即退100%”“超税负3%即征即退”“超税负8%即征即退”“超税负12%即征即退”“超税负6%即征即退”。

在开具数电票条件时，根据需求选择符合的优惠政策代码和税率，包括：

优惠政策选择“简易征收”，发票明细“优惠政策标识”项填写“01”，税率限制为3%或5%；

优惠政策选择“稀土产品”，发票明细“优惠政策标识”项填写“02”，“税率”栏次正常填写适用税率；

优惠政策选择“免税”，发票明细“优惠政策标识”项填写“03”，选择免税后，税率为0；

优惠政策选择“不征税”，发票明细“优惠政策标识”项填写“04”，选择不征税后，税率为0，该优惠政策不能混开，但选择不征税的编码为“6130000000000000000代收民航发展基金”时，支持与选择任何优惠政策标识（包含优惠政策标识为空）的“301030101010000000国内航空旅客运输服务”、“301030101020000000国际航空旅客运输服务”、“301030101030000000港澳台航空旅客运输服务”编码混开；选择不征税的编码为“61100000000000000不征税自来水”时，支持与选择任何优惠政策标识（包含优惠政策标识为空）的税收分类编码混开；

优惠政策选择“先征后退”，发票明细“优惠政策标识”项填写“05”，在发票明细的“税率”栏次填写适用税率；

优惠政策选择“100%先征后退”，发票明细“优惠政策标识”项填写“06”，在发票明细的“税率”栏次填写适用税率；

优惠政策选择“50%先征后退”，发票明细“优惠政策标识”项填写“07”，在发票明细的“税率”栏次填写适用税率；

优惠政策选择“按3%简易征收”，发票明细“优惠政策标识”项填写“08”，“税率”栏次限制为  $3\%$ ；

优惠政策选择“按5%简易征收”，发票明细“优惠政策标识”项填写“09”，“税率”栏次限制为  $5\%$ ；

优惠政策选择“按5%简易征收减按1.5%计征”，发票明细“优惠政策标识”项填写“10”，“税率”栏次限制为1.5%，该优惠政策不能与其他优惠政策混开，仅限不动产经营租赁能力可用；

优惠政策选择“即征即退  $30\%$  ”，发票明细“优惠政策标识”项填写“11”，“税率”栏次正常填写适用税率；

优惠政策选择“即征即退  $50\%$  ”，发票明细“优惠政策标识”项填写“12”，“税率”栏次正常填写适用税率；

优惠政策选择“即征即退  $70\%$  ”，发票明细“优惠政策标识”项填写“13”，“税率”栏次正常填写适用税率；

优惠政策选择“即征即退100%”，发票明细“优惠政策标识”项填写“14”，“税率”栏次正常填写适用税率；

优惠政策选择“超税负  $3\%$  即征即退”，发票明细“优惠政策标识”项填写“15”，“税率”栏次正常填写适用税率；

优惠政策选择“超税负  $8 \%$  即征即退”，发票明细“优惠政策标识”项填写“16”，“税率”栏次正常填写适用税率；

优惠政策选择“超税负12%即征即退”，发票明细“优惠政策标识”项填写“17”，“税率”栏次正常填写适用税率；

优惠政策选择“超税负  $6\%$  即征即退”，发票明细“优惠政策标识”项填写“18”，“税率”栏次正常填写适用税率。

# 8.2请求参数

<table><tr><td>序号</td><td>数据项标识</td><td>数据项名称</td><td>字段类型</td><td>长度</td><td>必须</td><td>说明</td></tr><tr><td>1</td><td>nsrsbh</td><td>纳税人识别号/统一社会信用代码</td><td>varchar</td><td>20</td><td>是</td><td>开票纳税人识别号/统一社会信用代码</td></tr><tr><td>2</td><td>sjc</td><td>时间戳</td><td>date</td><td></td><td>否</td><td>格式
: yyyyMMddHMMss
首次下载时为空;
非首次下载时,传入上次下载返回的时间戳
格式
: yyyyMMddHHmmss</td></tr><tr><td>3</td><td>sjswjgdm</td><td>省级税务机关代码</td><td>varchar</td><td>11</td><td>否</td><td></td></tr></table>

# 8.3请求报文示例

{"nsrsbh": "纳税人识别号/统一社会信用代码",

```json
"sjc": "时间戳",  
"sjswjgdm": "省级税务机关代码"  
}
```

8.4返回参数  

<table><tr><td>序号</td><td>数据项标识</td><td>数据项名称</td><td>字段类型</td><td>长度</td><td>必须</td><td>说明</td></tr><tr><td>1</td><td>returncode</td><td>返回码</td><td>varchar</td><td>2</td><td>是</td><td>00:成功
其它:失败</td></tr><tr><td>2</td><td>returnmsg</td><td>返回信息</td><td>varchar</td><td>2000</td><td>否</td><td>错误信息说明</td></tr><tr><td>3</td><td>sjc</td><td>时间戳</td><td>date</td><td></td><td>是</td><td>格式:
yyyyMMddHHmss
用于增量下载</td></tr><tr><td>4</td><td>count</td><td>总数量</td><td>number</td><td>10</td><td>是</td><td></td></tr><tr><td>5</td><td>fjbm</td><td>父级编码</td><td>varchar</td><td>19</td><td>是</td><td></td></tr><tr><td>6</td><td>sphfwssflhbbm</td><td>商品和服务税收分类合并编码</td><td>varchar</td><td>19</td><td>是</td><td></td></tr><tr><td>7</td><td>tdyslxdm</td><td>特定要素标签归类</td><td>varchar</td><td>2</td><td>否</td><td>01:成品油
02:稀土
03:建筑服务
04:货物运输
05:不动产销售
06:不动产租赁
07:代收车船使用税
08:通行费
09:旅客运输
10:医疗服务
11:农产品
12:拖拉机和联合收割机
13:机动车
14:光伏收购
15:卷烟</td></tr><tr><td>8</td><td>cezs</td><td>差额征税</td><td>varchar</td><td>1</td><td>否</td><td>Y:是
N:否</td></tr><tr><td>9</td><td>bzs</td><td>不征税</td><td>varchar</td><td>1</td><td>否</td><td>Y:是
N:否</td></tr><tr><td>10</td><td>jzjtdm</td><td>即征即退代码集合</td><td>varchar</td><td>150</td><td>否</td><td>01:增值税即征即退-软件产品
02:增值税即征即退-资源综合利用产品
03:增值税即征即退-管道运输服务
04:增值税即征即退-有形动产融资租赁服务
05:增值税即征即退-有形动产融资性售后回租服务
06:增值税即征即退-新型墙体材料
07:增值税即征即退-风力发电产品
08:增值税即征即退-光伏发电产品
09:增值税即征即退-动漫软件产品
10:增值税即征即退-飞机维修劳务
11:增值税即征即退-黄金
12:增值税即征即退-铂金</td></tr><tr><td>11</td><td>sphfwmc</td><td>商品和服务名称</td><td>varchar</td><td>150</td><td>是</td><td></td></tr><tr><td>12</td><td>sphfwfljc</td><td>商品和服务分类简称</td><td>varchar</td><td>120</td><td>是</td><td></td></tr><tr><td>13</td><td>sm</td><td>说明</td><td>varchar</td><td></td><td>否</td><td></td></tr><tr><td>14</td><td>zzssl</td><td>增值税税率</td><td>varchar</td><td>50</td><td>否</td><td>取值返回是中文
顿号连接的百分
数。例如3%、
5%</td></tr><tr><td>15</td><td>zsl</td><td>征收率</td><td>varchar</td><td>50</td><td>否</td><td>取值返回是中文
顿号连接的百分
数。例如3%、
5%</td></tr><tr><td>16</td><td>zzstsgl</td><td>增值税特殊管理</td><td>varchar</td><td>150</td><td>否</td><td></td></tr><tr><td>17</td><td>zzszcyj</td><td>增值税政策依据</td><td>varchar</td><td>300</td><td>否</td><td></td></tr><tr><td>18</td><td>zzstsnrdm(zzsjmszc
cmb)</td><td>增值税特殊内容代
码（增值税减免税
政策代码表）</td><td>varchar</td><td>300</td><td>否</td><td></td></tr><tr><td>19</td><td>xfsgl</td><td>消费税管理</td><td>varchar</td><td>150</td><td>否</td><td></td></tr><tr><td>20</td><td>xfszcyj</td><td>消费税政策依据</td><td>varchar</td><td>300</td><td>否</td><td></td></tr><tr><td>21</td><td>xfstsnrdm</td><td>消费税特殊内容代
码</td><td>varchar</td><td>300</td><td>否</td><td></td></tr><tr><td>22</td><td>gjz</td><td>关键字</td><td>mediumtext</td><td></td><td>否</td><td></td></tr><tr><td>23</td><td>sfhzx</td><td>是否汇总项</td><td>varchar</td><td>1</td><td>是</td><td>Y:是
N:否</td></tr><tr><td>24</td><td>dytjbm</td><td>对应统计局编码
(2011年版)或国
民行业代码</td><td>mediumtext</td><td></td><td>否</td><td></td></tr><tr><td>25</td><td>hgjcksppm</td><td>海关进出口商品品
目</td><td>mediumtext</td><td></td><td>否</td><td></td></tr><tr><td>26</td><td>qyrq</td><td>启用日期</td><td>date</td><td></td><td>是</td><td>格式：
yyyy-MM-dd</td></tr><tr><td>27</td><td>tyrq</td><td>停用日期</td><td>date</td><td></td><td>否</td><td>格式：
yyyy-MM-dd</td></tr><tr><td>28</td><td>hydm</td><td>行业代码</td><td>varchar</td><td>4</td><td>否</td><td>主行业代码特定
征收部门可空</td></tr><tr><td>29</td><td>dydhy</td><td>对应的行业</td><td>varchar</td><td>68</td><td>否</td><td></td></tr><tr><td>30</td><td>hydydzspm1</td><td>行业对应的征收品
目一</td><td>varchar</td><td>9</td><td>否</td><td></td></tr><tr><td>31</td><td>hydydzsmc1</td><td>行业对应的征收名
称一</td><td>varchar</td><td>210</td><td>否</td><td></td></tr><tr><td>32</td><td>hydydzspm2</td><td>行业对应的征收品目二</td><td>varchar</td><td>9</td><td>否</td><td></td></tr><tr><td>33</td><td>hydydzsmc2</td><td>行业对应的征收名称二</td><td>varchar</td><td>210</td><td>否</td><td></td></tr></table>

# 8.5返回报文示例

成功返回：

```json
{
"Response":{ "RequestId":"16位随机数字和字母组合", "Data":{ "returncode":"00", "returnmsg":"成功", "sjc":"时间戳", "count":"总数量", "ssbmList":[ { "fjbm":"父级编码", "sphfwssflhbbm":"商品和服务税收分类合并编码", "tdyslxdm":"特定要素标签归类", "cezs":"差额征税", "bzs":"不征税", "jzjtdm":"即征即退代码集合", "sphfwmc":"商品和服务名称", "sphfwfljc":"商品和服务分类简称", "sm":"说明", "zzssl":"增值税税率", "zsl":"征收率", "zzstsgl":"增值税特殊管理", "zzszcyj":"增值税政策依据", "zzstsnrdm":"增值税特殊内容代码（增值税减免税政策代码表）",
```

失败返回：  
```txt
"xfsgl": "消费税管理",  
"xfszcyj": "消费税政策依据",  
"xfstsnrdm": "消费税特殊内容代码",  
"gjz": "关键字",  
"sfhzx": "是否汇总项",  
"dytjjbm": "对应统计局编码（2011年版)  
"hgjcksppm": "海关进出口商品品目",  
"qyrq": "启用日期",  
"tyrq": "停用日期",  
"zspmList": [  
{  
"hydm": "行业代码",  
"dydhy": "对应的行业",  
"hydydzspm1": "行业对应的征收品目一",  
"hydydzsmc1": "行业对应的征收名称一",  
"hydydzspm2": "行业对应的征收品目二",  
"hydydzsmc2": "行业对应的征收名称二"  
}  
]  
}  
]  
}
```

```txt
{ "Response":{ "RequestId":"16位随机数字和字母组合", "Error":{
```

```json
"Code":"01"，  
"Message":"错误说明"  
}  
}
```

# 9.查询数电红字确认单明细信息

# 9.1接口说明

向企业提供数电红字确认单明细查询的功能，企业可通过红字确认单UUID、销售方纳税人识别号查询数电红字确认单明细信息，并将查询的结果保存在本地。使用此信息可以在申请数电红字确认单时校验蓝票是否可以红冲；在开具数电红字发票时校验是否有数电红字确认单明细。

建议企业定时下载/更新数电红字确认单明细信息,或在接收数电红字确认单明细、数电红字确认单明细变更时手工获取数电红字确认单明细信息。

根据红字确认单状态判断蓝字发票状态，具体如下：

1、当红字确认单状态为01无需确认时，蓝字发票购方未进行入账或勾选抵扣操作，红字确认单由销方发起无需确认。  
2、当红字确认单状态为02销方录入待购方确认时，蓝字发票购方已进行入账或勾选抵扣操作，销方申请红字确认单待购方确认。  
3、当红字确认单状态为03购方录入待销方确认时，蓝字发票购方已进行入账或勾选抵扣操作，购方申请红字确认单待销方确认。

9.2请求参数  

<table><tr><td>序号</td><td>数据项标识</td><td>数据项名称</td><td>字段类型</td><td>长度</td><td>必须</td><td>说明</td></tr><tr><td>1</td><td>uuid</td><td>红字确认单UUID</td><td>varchar</td><td>32</td><td>是</td><td></td></tr><tr><td>2</td><td>xsfnsrsbh</td><td>(销售方) 统一社会信用代码/纳税人识别号/身份证件号码</td><td>varchar</td><td>26</td><td>是</td><td></td></tr></table>

# 9.3请求报文示例

```json
{ "uuid":"红字确认单UUID", "xsfnsrsbh":"（销售方）统一社会信用代码/纳税人识别号/身份证件号码" }
```

# 9.4返回参数

<table><tr><td>序号</td><td>数据项标识</td><td>数据项名称</td><td>字段类型</td><td>长度</td><td>必须</td><td>说明</td></tr><tr><td>1</td><td>returncode</td><td>返回码</td><td>varchar</td><td>2</td><td>是</td><td>00:成功</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td>其它:失败</td></tr><tr><td>2</td><td>returnmsg</td><td>返回信息</td><td>varchar</td><td>2000</td><td>否</td><td>错误信息说明</td></tr><tr><td>3</td><td>uuid</td><td>红字确认单UUID</td><td>varchar</td><td>32</td><td>是</td><td></td></tr><tr><td>4</td><td>hzfpxxqrdbh</td><td>红字发票信息确认单编号</td><td>varchar</td><td>20</td><td>是</td><td></td></tr><tr><td>5</td><td>lrfsf</td><td>录入方身份</td><td>varchar</td><td>1</td><td>是</td><td>0:销方1:购方</td></tr><tr><td>6</td><td>xsfnsrsbh</td><td>(销售方)统一社会信用代码/纳税人识别号/身份证件号码</td><td>varchar</td><td>20</td><td>是</td><td></td></tr><tr><td>7</td><td>xsfmc</td><td>(销售方)名称</td><td>varchar</td><td>300</td><td>是</td><td></td></tr><tr><td>8</td><td>gmfsrsbh</td><td>(购买方)统一社会信用代码/纳税人识别号/身份证件号码</td><td>varchar</td><td>20</td><td>否</td><td></td></tr><tr><td>9</td><td>gmfmc</td><td>(购买方)名称</td><td>varchar</td><td>300</td><td>是</td><td></td></tr><tr><td>10</td><td>lzfpdm</td><td>蓝字发票代码</td><td>number</td><td>12</td><td>否</td><td></td></tr><tr><td>11</td><td>lzfphm</td><td>蓝字发票号码</td><td>number</td><td>20</td><td>否</td><td></td></tr><tr><td>12</td><td>sfzzfpbz</td><td>是否纸质发票标志</td><td>varchar</td><td>1</td><td>是</td><td>Y:纸质发票N:电子发票</td></tr><tr><td>13</td><td>lzkprq</td><td>蓝字发票开票日期</td><td>datetime</td><td></td><td>否</td><td>y y y y - M M - d dHH:mm:ss</td></tr><tr><td>14</td><td>lzhije</td><td>蓝字发票合计金额</td><td>number</td><td>18,2</td><td>否</td><td></td></tr><tr><td>15</td><td>lzhjse</td><td>蓝字发票合计税额</td><td>number</td><td>18,2</td><td>否</td><td></td></tr><tr><td>16</td><td>lzfpppzDm</td><td>蓝字发票票种代码</td><td>varchar</td><td>2</td><td>否</td><td>01:增值税专用发票02:普通发票03:机动车统一销售发票04:二手车统一销售发票</td></tr><tr><td>17</td><td>lzfpTdyslxDm</td><td>蓝字发票特定要素类型代码</td><td>varchar</td><td>2</td><td>否</td><td>01:成品油发票02:稀土发票03:建筑服务发票04:货物运输服务发票05:不动产销售服务发票06:不动产租赁</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td>服务发票
07:代收车船税
08:通行费
09:旅客运输服务发票
10:医疗服务(住院)发票
11:医疗服务(门诊)发票
12:自产农产品销售发票
13拖拉机和联合收割机发票
14:机动车
15:二手车
16:农产品收购发票
17:光伏收购发票
18:卷烟发票
20:农产品</td></tr><tr><td>18</td><td>hzcxje</td><td>红字冲销金额</td><td>number</td><td>18,2</td><td>是</td><td></td></tr><tr><td>19</td><td>hzcxse</td><td>红字冲销税额</td><td>number</td><td>18,2</td><td>是</td><td></td></tr><tr><td>20</td><td>chyyDm</td><td>红字发票冲红原因代码</td><td>varchar</td><td>2</td><td>是</td><td>01:开票有误
02:销货退回
03:服务中止
04:销售折让</td></tr><tr><td>21</td><td>hzqrxxztDm</td><td>红字确认单状态</td><td>varchar</td><td>2</td><td>是</td><td>01:无需确认
02:销方录入待购方确认
03:购方录入待销方确认
04:购销双方已确认
05:作废(销方录入购方否认)
06:作废(购方录入销方否认)
07:作废(超72小时未确认)
08:(发起方撤销)</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td>09:作废(确认后撤销)10作废(异常凭证)</td></tr><tr><td>22</td><td>qrrq</td><td>确认日期</td><td>datetime</td><td></td><td>否</td><td>y y y y - M M - d dHH:mm:ss</td></tr><tr><td>23</td><td>ykjhzfpbz</td><td>已开具红字发票标志</td><td>varchar</td><td>1</td><td>否</td><td>Y:已开具N:未开具</td></tr><tr><td>24</td><td>hzfphm</td><td>红字发票号码</td><td>String</td><td>20</td><td>否</td><td></td></tr><tr><td>25</td><td>hzkprq</td><td>红字开票日期</td><td>datetime</td><td></td><td>是</td><td>y y y y - M M - d dHH:mm:ss</td></tr><tr><td>26</td><td>yxbz</td><td>有效标志</td><td>varchar</td><td>1</td><td>是</td><td>Y:有效N:无效</td></tr><tr><td>27</td><td>cezslxDm</td><td>差额征税类型代码</td><td>varchar</td><td>2</td><td>否</td><td>空:非差额发票01:全额开票02:差额开票</td></tr><tr><td>28</td><td>lrrq</td><td>录入日期</td><td>datetime</td><td></td><td>是</td><td>y y y y - M M - d dHH:mm:ss</td></tr><tr><td>29</td><td>lzmxxh</td><td>蓝字发票明细序号</td><td>number</td><td>8</td><td>是</td><td></td></tr><tr><td>30</td><td>xh</td><td>序号</td><td>number</td><td>8</td><td>是</td><td></td></tr><tr><td>31</td><td>sphfwssflhbbm</td><td>商品和服务税收分类合并编码</td><td>varchar</td><td>19</td><td>是</td><td></td></tr><tr><td>32</td><td>hwhyslwfwmc</td><td>货物或应税劳务、服务名称</td><td>varchar</td><td>300</td><td>是</td><td></td></tr><tr><td>33</td><td>spfwjc</td><td>商品服务简称</td><td>varchar</td><td>120</td><td>是</td><td></td></tr><tr><td>34</td><td>xmmc</td><td>项目名称</td><td>varchar</td><td>600</td><td>是</td><td></td></tr><tr><td>35</td><td>gxxh</td><td>规格型号</td><td>varchar</td><td>150</td><td>否</td><td></td></tr><tr><td>36</td><td>dw</td><td>单位</td><td>varchar</td><td>300</td><td>否</td><td></td></tr><tr><td>37</td><td>fpsdj</td><td>单价</td><td>varchar</td><td>25</td><td>否</td><td>如“数量”栏次非空,则本栏次必须非空</td></tr><tr><td>38</td><td>fpspl</td><td>数量</td><td>varchar</td><td>25</td><td>否</td><td>如“单价”栏次非空,则本栏次必须非空</td></tr><tr><td>39</td><td>je</td><td>金额</td><td>number</td><td>18,2</td><td>是</td><td></td></tr><tr><td>40</td><td>sl1</td><td>税率</td><td>number</td><td>16,6</td><td>是</td><td></td></tr><tr><td>41</td><td>se</td><td>税额</td><td>number</td><td>18,2</td><td>是</td><td></td></tr><tr><td>42</td><td>kce</td><td>扣除额</td><td>number</td><td>18,2</td><td>否</td><td>蓝票扣除额的负数</td></tr><tr><td>43</td><td>yhzCBS</td><td>优惠政策标识</td><td>varchar</td><td>2</td><td>否</td><td></td></tr></table>

# 9.5返回报文示例

# 成功时返回：

```json
{ "Response": { "RequestId":"16位随机数字和字母组合", "Data": { "returncode":"00", "returnsmsg":"成功", "uuid":"红字确认单UUID", "hzfpxxqrdbh":"红字发票信息确认单编号", "lrfsf":"录入方身份", "xsfnsrsbh":"（销售方）统一社会信用代码/纳税人识别号/身份证件号码", "xsfmc":"销售方名称", "gmfnsrsbh":"（购买方）统一社会信用代码/纳税人识别号/身份证件号码", "gmfmc":"购买方名称", "lzfpdm":"蓝字发票代码", "lzfphm":"蓝字发票号码", "sfzzfpbz":"是否纸质发票标志", "lzkprq":"蓝字发票开票日期", "lzhije":"蓝字发票合计金额", "lzhjse":"蓝字发票合计税额", "lzfppzDm":"蓝字发票票种代码", "lzfpTdyslxDm":"蓝字发票特定要素类型代码", "hzcxje":"红字冲销金额", "hzcxse":"红字冲销税额", "chyyDm":"红字发票冲红原因代码", "hzqrxztDm":"红字确认信息状态代码",
```

```json
"qrrq":"确认日期",  
"ykjhzfpbz":"已开具红字发票标志",  
"hzfphm":"红字发票号码",  
"hzkprq":"红字开票日期",  
"yxbz":"有效标志",  
"cezslxDm":"差额征税类型代码",  
"lrrq":"录入日期",  
"hzqrxmxList":[  
{  
"xh":"序号",  
"lzmmxh":"蓝字发票明细序号",  
"sphfwssflhbbm":"商品和服务税收分类合并编码",  
"hwhyslwfwmc":"货物或应税劳务、服务名称",  
"spfwjc":"商品服务简称",  
"xmmc":"项目名称",  
"gxxh":"规格型号",  
"dw":"单位",  
"fpspdj":"单价",  
"fpspsl":"数量",  
"je":"金额",  
"sl1":"税率",  
"se":"税额",  
"kce":"扣除额",  
"yhzcbs":"优惠政策标识"  
}  
]  
}
```

失败时返回：

```json
{
    "Response": {
        "RequestId": "16位随机数字和字母组合",
        "Error": {
            "Code": "01",
            "Message": "错误说明"
        }
    }
}
```

# 10.数电票上传

# 10.1接口说明

给企业提供上传预开具的数电发票功能，上传成功后给企业返回信息。

税务局端接收到企业上传的数电票后，依次校验企业是具备开票条件、发票信息是否合规、是否超过发票额度、数电票号码是否合法、发票是否属于直连单位，当校验不通过时，不接收企业上传的数电票，返回具体错误信息。每次上传最大票量为100张数电票。

# 10.2请求参数

<table><tr><td>序号</td><td>数据项标识</td><td>数据项名称</td><td>字段类型</td><td>长度</td><td>必须</td><td>说明</td></tr><tr><td>1</td><td>fphm</td><td>发票号码</td><td>varchar</td><td>20</td><td>是</td><td></td></tr><tr><td>2</td><td>lzfpbz</td><td>蓝字发票标志</td><td>varchar</td><td>1</td><td>是</td><td>0:蓝字发票
1:红字发票</td></tr><tr><td>3</td><td>ptbh</td><td>平台编号</td><td>varchar</td><td>20</td><td>是</td><td>直连单位ID</td></tr><tr><td>4</td><td>fppz</td><td>发票票种</td><td>varchar</td><td>2</td><td>是</td><td>01:数电专
02:数电普</td></tr><tr><td>5</td><td>gmfzrrbz</td><td>购买方自然人标志</td><td>varchar</td><td>1</td><td>否</td><td>Y:购买方是自然人
N:购买方非自然人</td></tr><tr><td>6</td><td>tdys</td><td>特定要素</td><td>varchar</td><td>2</td><td>否</td><td>空:非特定要素</td></tr><tr><td>7</td><td>qyDm</td><td>区域代码</td><td>varchar</td><td>20</td><td>是</td><td></td></tr><tr><td>8</td><td>cezslxDm</td><td>差额征税类型代码</td><td>varchar</td><td>2</td><td>否</td><td>空:非差额发票
01:全额开票
02:差额开票</td></tr><tr><td>9</td><td>sgfplxDm</td><td>收购发票类型代码</td><td>varchar</td><td>2</td><td>否</td><td>空:非收购发票
01:农产品收购发票
02:光伏收购发票
03:二手车收购发票</td></tr><tr><td>10</td><td>ckywyszczDm</td><td>出口业务适用政策代码</td><td>varchar</td><td>2</td><td>否</td><td>空:非出口业务
01:退税政策
02:免税政策
03:征税政策</td></tr><tr><td>11</td><td>zzsjzjtDm</td><td>增值税即征即退代码</td><td>varchar</td><td>2</td><td>否</td><td>空:非增值税即征即退
01:软件产品发票
02:资源综合利用产品发票
03:管道运输服务发票
04:有形动产融资租赁服务
05:有形动产融资性售后回租服务发票
06:新型墙体材料发票
07:风力发电产品发票
08:光伏发电产品发票
09:动漫软件产品发票
10:飞机维修劳务发票
11:黄金发票
12:铂金发票</td></tr><tr><td>12</td><td>xsfnsrsbh</td><td>(销售方)统一社会信用代码/纳税人</td><td>varchar</td><td>20</td><td>是</td><td></td></tr><tr><td></td><td></td><td>识别号/身份证件号码</td><td></td><td></td><td></td><td></td></tr><tr><td>13</td><td>xsfmc</td><td>(销售方)名称</td><td>varchar</td><td>300</td><td>是</td><td></td></tr><tr><td>14</td><td>xsfdz</td><td>销售方地址</td><td>varchar</td><td>300</td><td>否</td><td></td></tr><tr><td>15</td><td>xsfdh</td><td>销售方电话</td><td>varchar</td><td>60</td><td>否</td><td></td></tr><tr><td>16</td><td>xsfkhh</td><td>销售方开户行</td><td>varchar</td><td>120</td><td>否</td><td></td></tr><tr><td>17</td><td>xsfzh</td><td>销售方账号</td><td>varchar</td><td>50</td><td>否</td><td></td></tr><tr><td>18</td><td>gmfnrsbh</td><td>(购买方)统一社会信用代码/纳税人识别号/身份证件号码</td><td>varchar</td><td>20</td><td>否</td><td>开具数电专票时,必填</td></tr><tr><td>19</td><td>gmfmc</td><td>(购买方)名称</td><td>varchar</td><td>300</td><td>是</td><td></td></tr><tr><td>20</td><td>gmfdz</td><td>购买方地址</td><td>varchar</td><td>300</td><td>否</td><td></td></tr><tr><td>21</td><td>gmfdh</td><td>购买方电话</td><td>varchar</td><td>60</td><td>否</td><td></td></tr><tr><td>22</td><td>gmfkhh</td><td>购买方开户行</td><td>varchar</td><td>120</td><td>否</td><td></td></tr><tr><td>23</td><td>gmfzh</td><td>购买方账号</td><td>varchar</td><td>50</td><td>否</td><td></td></tr><tr><td>24</td><td>gmfjbr</td><td>购买方经办人姓名</td><td>varchar</td><td>150</td><td>否</td><td></td></tr><tr><td>25</td><td>jbrsfzjhm</td><td>购买方经办人证件号码</td><td>varchar</td><td>30</td><td>否</td><td></td></tr><tr><td>26</td><td>gmfbrlxdh</td><td>购买方经办人联系电话</td><td>varchar</td><td>60</td><td>否</td><td></td></tr><tr><td>27</td><td>hjjc</td><td>合计金额</td><td>number</td><td>18,2</td><td>是</td><td></td></tr><tr><td>28</td><td>hjs</td><td>合计税额</td><td>number</td><td>18,2</td><td>是</td><td></td></tr><tr><td>29</td><td>jshj</td><td>价税合计</td><td>number</td><td>18,2</td><td>是</td><td></td></tr><tr><td>30</td><td>skyhmc</td><td>收款银行名称</td><td>varchar</td><td>120</td><td>否</td><td></td></tr><tr><td>31</td><td>skyhzh</td><td>收款银行账号</td><td>varchar</td><td>100</td><td>否</td><td></td></tr><tr><td>32</td><td>jsfs</td><td>结算方式</td><td>varchar</td><td>2</td><td>否</td><td>01:现金
02:银行转账
03:票据
04:第三方支付
05:预付卡
99:其他</td></tr><tr><td>33</td><td>ysxwfsd</td><td>应税行为发生地</td><td>varchar</td><td>11</td><td>否</td><td></td></tr><tr><td>34</td><td>kpr</td><td>开票人</td><td>varchar</td><td>300</td><td>是</td><td></td></tr><tr><td>35</td><td>kprzjhm</td><td>开票人证件号码</td><td>varchar</td><td>30</td><td>否</td><td></td></tr><tr><td>36</td><td>kprzjlx</td><td>开票人证件类型</td><td>varchar</td><td>4</td><td>否</td><td>100:单位
101:组织机构代码证
102:营业执照
103:税务登记证
199:其他单位证件
200:个人
201:居民身份证
202:军官证
203:武警警官证
204:士兵证
205:军队离退休干部证
206:残疾人证
207:残疾军人证(1-8级)
208:外国护照
209:港澳同胞回乡证
210:港澳居民来往内地通行证
211:台胞证
212:中华人民共和国往来港澳通行证
213:台湾居民来往大陆通行证
214:大陆居民往来台湾通行证
215:外国人居留证
216:外交官证
217:使(领事)馆证</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td>218:海员证
219:香港永久性居民身份证
220:台湾身份证
221:澳門特別行政区永久性居民身份证
222:外国人身份证件
223:高校毕业生自主创业证
224:就业失业登记证
225:退休证
220:离休证
227:中国护照
228:城镇退役士兵自谋职业证
229:随军家属身份证明
230:中国人民解放军军官转业证书
231:中国人民解放军义务兵退出现役证
232:中国人民解放军士官退出现役证
233:外国人永久居留身份证(外国人永久居留证)
234:就业创业证
235:香港特別行政区护照
236:澳門特別行政区护照
237:中华人民共和国港澳居民</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td>居住证
238:中华人民共和国台湾居民居住证
239:《中华人民共和国外国人工作许可证》(A类)
240:《中华人民共和国外国人工作许可证》(B类)
241:《中华人民共和国外国人工作许可证》(C类)
291:出生医学证明
299:其他个人证件</td></tr><tr><td>37</td><td>dylzfphm</td><td>对应蓝字发票号码</td><td>varchar</td><td>20</td><td>否</td><td>是否蓝字发票标志为1时,此节点有内容
红票开具时必传;
如果红冲的是税控发票,对应蓝字发票号码的填写规则为税控发票的发票代码+发票号码。</td></tr><tr><td>38</td><td>hzqrxxdbh</td><td>红字确认信息单编号</td><td>varchar</td><td>20</td><td>否</td><td>是否蓝字发票标志为1时,此节点有内容
红票开具时必传</td></tr><tr><td>39</td><td>hzqrduuid</td><td>红字确认单uuid</td><td>varchar</td><td>32</td><td>否</td><td>是否蓝字发票标志为1时,此节点有内容红票开具时必传</td></tr><tr><td>40</td><td>bz</td><td>备注</td><td>varchar</td><td>450</td><td>否</td><td></td></tr><tr><td>41</td><td>ip</td><td>服务器地址</td><td>varchar</td><td>20</td><td>是</td><td>需自行采集开票申请设备</td></tr><tr><td>42</td><td>macdz</td><td>mac地址</td><td>char</td><td>20</td><td>是</td><td>需自行采集开票申请设备</td></tr><tr><td>43</td><td>cpuid</td><td>CPU序列号</td><td>char</td><td>20</td><td>否</td><td></td></tr><tr><td>44</td><td>zbxlh</td><td>主板序列号</td><td>varchar</td><td>20</td><td>否</td><td></td></tr><tr><td>45</td><td>kprq</td><td>开票日期</td><td>datetime</td><td></td><td>是</td><td>格式: yyyy-MM-dd HH:mm:ss</td></tr><tr><td>46</td><td>sfzxsfyhzhbq</td><td>是否展示销售方银行账号标签</td><td>varchar</td><td>1</td><td>否</td><td>Y:展示
N:不展示</td></tr><tr><td>47</td><td>sfzsgmfyhzhbq</td><td>是否展示购买方银行账号标签</td><td>varchar</td><td>1</td><td>否</td><td>Y:展示
N:不展示</td></tr><tr><td>48</td><td>skrxm</td><td>收款人姓名</td><td>varchar</td><td>150</td><td>否</td><td></td></tr><tr><td>49</td><td>fhrxm</td><td>复核人姓名</td><td>varchar</td><td>75</td><td>否</td><td></td></tr><tr><td>50</td><td>mxxh</td><td>明细序号</td><td>Number</td><td>8</td><td>是</td><td></td></tr><tr><td>51</td><td>dylzfpmxxh</td><td>对应蓝字发票明细序号</td><td>Number</td><td>8</td><td>否</td><td>红票必传</td></tr><tr><td>52</td><td>xmmc</td><td>项目名称</td><td>varchar</td><td>600</td><td>是</td><td></td></tr><tr><td>53</td><td>hwhyslwfmc</td><td>货物或应税劳务、服务名称</td><td>varchar</td><td>300</td><td>是</td><td>拼装规则:
“*商品服务简 称(spfwjc)*”+
“项目名称(xmmc)”</td></tr><tr><td>54</td><td>spfwjc</td><td>商品服务简称</td><td>varchar</td><td>120</td><td>是</td><td></td></tr><tr><td>55</td><td>ggxh</td><td>规格型号</td><td>varchar</td><td>150</td><td>否</td><td></td></tr><tr><td>56</td><td>dw</td><td>单位</td><td>varchar</td><td>300</td><td>否</td><td></td></tr><tr><td>57</td><td>sl</td><td>数量</td><td>varchar</td><td>25</td><td>否</td><td>如“单价”栏次非空,则本栏次必须非空</td></tr><tr><td>58</td><td>dj</td><td>单价</td><td>varchar</td><td>25</td><td>否</td><td>如“数量”栏次非空,则本栏次必须非空</td></tr><tr><td>59</td><td>je</td><td>金额</td><td>number</td><td>18,2</td><td>是</td><td></td></tr><tr><td>60</td><td>slv</td><td>增值税税率/征收率</td><td>number</td><td>16,6</td><td>是</td><td></td></tr><tr><td>61</td><td>se</td><td>税额</td><td>number</td><td>18,2</td><td>是</td><td></td></tr><tr><td>62</td><td>hsje</td><td>含税金额</td><td>number</td><td>18,2</td><td>是</td><td></td></tr><tr><td>63</td><td>kce</td><td>扣除额</td><td>number</td><td>18,2</td><td>否</td><td></td></tr><tr><td>64</td><td>sphfwssflhbbm</td><td>商品和服务税收分类合并编码</td><td>varchar</td><td>19</td><td>是</td><td></td></tr><tr><td>65</td><td>fphxz</td><td>发票行性质</td><td>varchar</td><td>2</td><td>是</td><td>00:正常行
01:折扣行
02:被折扣行</td></tr><tr><td>66</td><td>yhzcbs</td><td>优惠政策标识</td><td>varchar</td><td>2</td><td>否</td><td>01:简易征收
02:稀土产品
03:免税
04:不征税
05:先征后退
06:100%先征后退
07:50%先征后退
08:按3%简易征收
09:按5%简易征收
10:按5%简易征收减按1.5%计征
11:即征即退30%
12:即征即退50%
13:即征即退70%
14:即征即退100%
15:超税负3%即征即退
16:超税负8%即征即退
17:超税负12%即征即退
18:超税负6%即征即退</td></tr><tr><td>67</td><td>fjysmc</td><td>附加要素名称</td><td>String</td><td>200</td><td>否</td><td></td></tr><tr><td>68</td><td>fjyslx</td><td>附加要素类型</td><td>String</td><td>200</td><td>否</td><td></td></tr><tr><td>69</td><td>fjysz</td><td>附加要素值</td><td>String</td><td>200</td><td>否</td><td></td></tr><tr><td>70</td><td>xh</td><td>序号</td><td>number</td><td>8</td><td>否</td><td></td></tr><tr><td>71</td><td>pzlx</td><td>凭证类型</td><td>varchar</td><td>2</td><td>否</td><td>01: 数电票
02: 增值税专用发票
03: 增值税普通发票
04: 营业税发票
05: 财政票据
06: 法院裁决书
07: 契税完税凭证
08: 其他发票类
09: 其他扣除凭证</td></tr><tr><td>72</td><td>fpdm</td><td>发票代码</td><td>varchar</td><td>12</td><td>否</td><td></td></tr><tr><td>73</td><td>fphm</td><td>发票号码</td><td>varchar</td><td>30</td><td>否</td><td></td></tr><tr><td>74</td><td>cepzhm</td><td>差额凭证号码</td><td>varchar</td><td>40</td><td>否</td><td></td></tr><tr><td>75</td><td>kjrq</td><td>开具日期</td><td>datetime</td><td></td><td>否</td><td>格式必须为“ yyyy-MM-dd”</td></tr><tr><td>76</td><td>pzhjje</td><td>凭证合计金额</td><td>number</td><td>18,2</td><td>否</td><td></td></tr><tr><td>77</td><td>bckcje</td><td>本次扣除金额</td><td>number</td><td>18,2</td><td>否</td><td>该字段需要小于等于凭证合计金额。</td></tr><tr><td>78</td><td>bz</td><td>备注</td><td>varchar</td><td>450</td><td>否</td><td></td></tr></table>

# 10.3请求报文示例

```json
[ 
{ 
    "fphm": "发票号码", 
    "lzfpbz": "蓝字发票标志", 
    "ptbh": "平台编号", 
    "fppz": "发票票种", 
    "gmfzrrbz": "购买方自然人标志", 
    "tdys": "特定要素", 
    "qyDm": "区域代码", 
    "cezslxDm": "差额征税类型代码", 
    "sgfplxDm": "收购发票类型代码", 
    "ckywszcDm": "出口业务适用政策代码", 
]
```

```txt
"zzsjzjtDm":"增值税即征即退代码",  
"xsfnsrsbh":"（销售方）统一社会信用代码/纳税人识别号/身份证件号码",  
"xsfmc":"（销售方）名称",  
"xsfdz":"销售方地址",  
"xsfdh":"销售方电话",  
"xsfkhh":"销售方开户行",  
"xsfzh":"销售方账号",  
"gmfnsrsbh":"（购买方）统一社会信用代码/纳税人识别号/身份证件号码",  
"gmfmc":"（购买方）名称",  
"gmfdz":"购买方地址",  
"gmfdh":"购买方电话",  
"gmfkhh":"购买方开户行名称",  
"gmfzh":"购买方开户行银行账号",  
"gmfjbr":"经办人",  
"jbrsfzjhvm":"经办人身份证件号码",  
"gmfbrlxdh":"经办人联系电话",  
"hjje":"合计金额",  
"hjse":"合计税额",  
"jsjh":"价税合计",  
"skyhmc":"收款银行名称",  
"skyhzh":"收款银行账号",  
"jsfs":"结算方式",  
"ysxwfsd":"应税行为发生地",  
"kpr":"开票人",  
"kprzjhvm":"开票人证件号码",  
"kprzjlx":"开票人证件类型",  
"dylzfphm":"对应蓝字发票号码",  
"hzqrxdbh":"红字确认信息单编号",  
"hzqrduuid":"红字确认单uuid",
```

```txt
"bz":"备注",  
"ip":"服务器地址",  
"macdz":"mac地址",  
"cpuid":"CPU序列号",  
"zbxlh":"主板序列号",  
"kprq":"开票日期",  
"sfzxsfyhzhbq":"是否展示销售方银行账号标签",  
"sfzsgmfyhzhbq":"是否展示购买方银行账号标签",  
"skrxm":"收款人姓名",  
"frhxm":"复核人姓名",  
"fpmxList":[  
{  
"Mxxh":"明细序号",  
"dylzfpmxxh":"对应蓝字发票明细序号",  
"hwhyslwfwmc":"货物或应税劳务、服务名称",  
"spfwjc":"商品服务简称",  
"xmmc":"项目名称",  
"ggxh":"规格型号",  
"dw":"单位",  
"sl":"数量",  
"dj":"单价",  
"je":"金额",  
"slv":"增值税税率/征收率",  
"se":"税额",  
"hsje":"含税金额",  
"kce":"扣除额",  
"sphfwssflhbbm":"商品和服务税收分类合并编码",  
"fphxz":"发票行性质",  
"yhzcbs":"优惠政策标识"
```

```json
}  
],  
"fjysList": [  
{  
"fjysmc": "附加要素名称",  
"fjyslx": "附加要素类型",  
"fjysz": "附加要素值"  
}  
],  
"cekcList": [  
{  
"xh": "序号",  
pzlx": "凭证类型",  
"fpdm": "发票代码",  
"fphm": "发票号码",  
"cepzhm": "差额凭证号码",  
"kjrq": "开具日期",  
"pzhjje": "凭证合计金额",  
"bckcje": "本次扣除金额",  
"bz": "备注"  
}  
]  
}
```

# 10.4返回参数

<table><tr><td>序号</td><td>数据项标识</td><td>数据项名称</td><td>字段类型</td><td>长度</td><td>必须</td><td>说明</td></tr><tr><td>1</td><td>returncode</td><td>返回码</td><td>varchar</td><td>2</td><td>是</td><td>00: 成功
其它: 失败</td></tr><tr><td>2</td><td>returnmsg</td><td>返回信息</td><td>varchar</td><td>2000</td><td>否</td><td>错误信息说明</td></tr><tr><td>3</td><td>sslsh</td><td>受理流水号</td><td>String</td><td>40</td><td>是</td><td></td></tr></table>

# 10.5返回报文示例

成功返回：

```json
{ "Response": { "RequestId":"16位随机数字和字母组合", "Data": { "returncode":"00", "returnmsg":"成功", "sllsh":"受理流水号" } } } }
```

失败返回：

```json
{ "Response":{ "RequestId":"16位随机数字和字母组合", "Error":{ "Code":"01"， "Message":"错误说明" } } 1
```

# 11.查询数电红字确认单列表信息

# 11.1接口说明

向企业提供查询数电红字确认单列表信息的功能，企业可通过购买方纳税人识别号、销售方纳

税人识别号、蓝字发票号码、录入日期起、录入日期止等条件查询数电红字确认单列表信息，并将查询的结果保存在本地。使用此信息可以在申请数电红字确认单时校验数电蓝字发票是否可以红冲；在开具数电红字发票时校验是否有数电红字确认单。

建议企业定时下载/更新数电红字确认单列表信息,或在接收数电红字确认单、数电红字确认单变更时手工获取数电红字确认单列表信息。

根据红字确认单状态判断蓝字发票状态，具体如下：

1、当红字确认单状态为01无需确认时，蓝字发票购方未进行入账或勾选抵扣操作，红字确认单由销方发起无需确认。  
2、当红字确认单状态为02销方录入待购方确认时，蓝字发票购方已进行入账或勾选抵扣操作，销方申请红字确认单待购方确认。  
3、当红字确认单状态为03购方录入待销方确认时，蓝字发票购方已进行入账或勾选抵扣操作，购方申请红字确认单待销方确认。

11.2请求参数  

<table><tr><td>序号</td><td>数据项标识</td><td>数据项名称</td><td>字段类型</td><td>长度</td><td>必须</td><td>说明</td></tr><tr><td>1</td><td>yhjslx</td><td>用户角色类型</td><td>varchar</td><td>2</td><td>是</td><td>0:销方1:购方</td></tr><tr><td>2</td><td>xsfnsrsbh</td><td>(销售方)统一社会信用代码/纳税人识别号/身份证件号码</td><td>varchar</td><td>20</td><td>否</td><td>条件必录,作为销方,必录</td></tr><tr><td>3</td><td>xsfmc</td><td>(销售方)名称</td><td>varchar</td><td>300</td><td>否</td><td>条件必录,作为销方,必录</td></tr><tr><td>4</td><td>gmfnsrsbh</td><td>(购买方)统一社会信用代码/纳税人识别号/身份证件号码</td><td>varchar</td><td>20</td><td>否</td><td>条件必录,作为购方,必录</td></tr><tr><td>5</td><td>gmfmc</td><td>(购买方)名称</td><td>varchar</td><td>300</td><td>否</td><td>条件必录,作为购方,必录</td></tr><tr><td>6</td><td>lrfsf</td><td>录入方身份</td><td>varchar</td><td>2</td><td>否</td><td>0:销方1:购方</td></tr><tr><td>7</td><td>lrrqq</td><td>录入日期起</td><td>date</td><td>20</td><td>否</td><td>yyyy-MM-dd</td></tr><tr><td>8</td><td>lrrqz</td><td>录入日期止</td><td>date</td><td>20</td><td>否</td><td>yyyy-MM-dd</td></tr><tr><td>9</td><td>lzfpdm</td><td>蓝字发票代码</td><td>varchar</td><td>12</td><td>否</td><td></td></tr><tr><td>10</td><td>lzfphm</td><td>蓝字发票号码</td><td>varchar</td><td>20</td><td>否</td><td></td></tr><tr><td>11</td><td>hzfpxxqrdbh</td><td>红字确认单编号</td><td>varchar</td><td>20</td><td>否</td><td></td></tr><tr><td>12</td><td>hzqrxxtDm</td><td>红字确认信息状态代码</td><td>varchar</td><td>2</td><td>否</td><td>01:无需确认02:销方录入待购方确认03:购方录入待销方确认04:购销双方已</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td>确认
05:作废(销方录入购方否认)
06:作废(购方录入销方否认)
07:作废(超72小时未确认)
08:(发起方撤销)
09:作废(确认后撤销)
10:作废(异常凭证)</td></tr><tr><td>13</td><td>fppzDm</td><td>发票票种代码</td><td>varchar</td><td>2</td><td>否</td><td>01:增值税专用发票
02:普通发票
03:机动车统一销售发票
04:二手车统一销售发票
05:铁路客票电子发票
06:航空运输电子客票行程单</td></tr><tr><td>14</td><td>pageNumber</td><td>页码</td><td>number</td><td>10</td><td>否</td><td></td></tr><tr><td>15</td><td>pageSize</td><td>每页数量</td><td>number</td><td>10</td><td>否</td><td></td></tr></table>

# 11.3请求报文示例

```json
{"yhjslx":"用户角色类型", "xsfnsrsbh":"（销售方）统一社会信用代码/纳税人识别号/身份证件号码", "xsfmc":"（销售方）名称", "gmfnsrsbh":"（购买方）统一社会信用代码/纳税人识别号/身份证件号码", "gmfmc":"（购买方）名称", "lrfsf":"录入方身份", "lrrqq":"录入日期起", "lrrqz":"录入日期止", "lzfpdm":"蓝字发票代码",
```

```json
"lzfphm":"蓝字发票号码",  
"hzfpxxqrdbh":"红字确认单编号",  
"hzqrxztDm":"红字确认信息状态代码",  
"fppzDm":"发票票种代码",  
"pageNum":"页码",  
"規模":"每页数量"  
}
```

11.4返回参数  

<table><tr><td>序号</td><td>数据项标识</td><td>数据项名称</td><td>字段类型</td><td>长度</td><td>必须</td><td>说明</td></tr><tr><td>1</td><td>returncode</td><td>返回码</td><td>varchar</td><td>2</td><td>是</td><td>00:成功
其它:失败</td></tr><tr><td>2</td><td>returnmsg</td><td>返回信息</td><td>varchar</td><td>2000</td><td>否</td><td>错误信息说明</td></tr><tr><td>3</td><td>total</td><td>总数量</td><td>varchar</td><td>10</td><td>是</td><td></td></tr><tr><td>4</td><td>uuid</td><td>红字确认单UUID</td><td>varchar</td><td>32</td><td>是</td><td></td></tr><tr><td>5</td><td>hzfpxxqrdbh</td><td>红字发票信息确认单编号</td><td>varchar</td><td>20</td><td>是</td><td></td></tr><tr><td>6</td><td>lrfsf</td><td>录入方身份</td><td>varchar</td><td>2</td><td>是</td><td>0:销方1:购方</td></tr><tr><td>7</td><td>xsfnsrsbh</td><td>(销售方)统一社会信用代码/纳税人识别号/身份证件号码</td><td>varchar</td><td>20</td><td>否</td><td></td></tr><tr><td>8</td><td>xsfmc</td><td>(销售方)名称</td><td>varchar</td><td>300</td><td>是</td><td></td></tr><tr><td>9</td><td>gmfsrsbh</td><td>(购买方)统一社会信用代码/纳税人识别号/身份证件号码</td><td>varchar</td><td>20</td><td>是</td><td></td></tr><tr><td>10</td><td>gmfmc</td><td>(购买方)名称</td><td>varchar</td><td>300</td><td>是</td><td></td></tr><tr><td>11</td><td>lzfpdm</td><td>蓝字发票代码</td><td>varchar</td><td>12</td><td>否</td><td></td></tr><tr><td>12</td><td>lzfphm</td><td>蓝字发票号码</td><td>varchar</td><td>20</td><td>否</td><td></td></tr><tr><td>13</td><td>sfzzfphz</td><td>是否纸质发票标志</td><td>varchar</td><td>1</td><td>是</td><td>Y=纸质发票, N=电子发票</td></tr><tr><td>14</td><td>lzkprq</td><td>蓝字发票开票日期</td><td>datetime</td><td></td><td>否</td><td>y y y - M M - d d
HH:mm:ss</td></tr><tr><td>15</td><td>lzhije</td><td>蓝字发票合计金额</td><td>number</td><td>18,2</td><td>否</td><td></td></tr><tr><td>16</td><td>lzhjse</td><td>蓝字发票合计税额</td><td>number</td><td>18,2</td><td>否</td><td></td></tr><tr><td>17</td><td>lzfppzDm</td><td>蓝字发票票种代码</td><td>varchar</td><td>2</td><td>否</td><td>01:增值税专用发票</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td>02:普通发票
03:机动车统一销售发票
04:二手车统一销售发票</td></tr><tr><td>18</td><td>lzfpTdyslxDm</td><td>蓝字发票特定要素类型代码</td><td>varchar</td><td>2</td><td>否</td><td>01:成品油发票
02:稀土发票
03:建筑服务发票
04:货物运输服务发票
05:不动产销售服务发票
06:不动产租赁服务发票
07:代收车船税
08:通行费
09:旅客运输服务发票
10:医疗服务(住院)发票
11:医疗服务(门诊)发票
12:自产农产品销售发票
13拖拉机和联合收割机发票
14:机动车
15:二手车
16:农产品收购发票
17:光伏收购发票
18:卷烟发票
20:农产品</td></tr><tr><td>19</td><td>hzcxje</td><td>红字冲销金额</td><td>number</td><td>18,2</td><td>是</td><td></td></tr><tr><td>20</td><td>hzcxse</td><td>红字冲销税额</td><td>number</td><td>18,2</td><td>是</td><td></td></tr><tr><td>21</td><td>hzqrdmxsl</td><td>红字确认单明细数量</td><td>number</td><td>10</td><td>是</td><td></td></tr><tr><td>22</td><td>chyyDm</td><td>红字发票冲红原因代码</td><td>varchar</td><td>2</td><td>是</td><td>01:开票有误
02:销货退回</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td>03:服务中止
04:销售折让</td></tr><tr><td>23</td><td>hzqrxxtDm</td><td>红字确认信息状态代码</td><td>varchar</td><td>2</td><td>是</td><td></td></tr><tr><td>24</td><td>qrrq</td><td>确认日期</td><td>datetime</td><td></td><td>否</td><td>y y y y - M M - d d
HH:mm:ss</td></tr><tr><td>25</td><td>ykjhzfpbz</td><td>已开具红字发票标志</td><td>varchar</td><td>1</td><td>否</td><td>Y:已开具
N:未开具</td></tr><tr><td>26</td><td>hzfphm</td><td>红字发票号码</td><td>varchar</td><td>20</td><td>否</td><td></td></tr><tr><td>27</td><td>hzkprq</td><td>红字开票日期</td><td>datetime</td><td></td><td>是</td><td>y y y y - M M - d d
HH:mm:ss</td></tr><tr><td>28</td><td>yxbz</td><td>有效标志</td><td>varchar</td><td>1</td><td>是</td><td>Y:有效
N:无效</td></tr><tr><td>29</td><td>lrrq</td><td>录入日期</td><td>datetime</td><td></td><td>是</td><td>y y y y - M M - d d
HH:mm:ss</td></tr></table>

# 11.5返回报文示例

成功时返回：

```json
{
"Response": {
"RequestId":"16位随机数字和字母组合",
"Data": {
"returncode":"00",
"returnsmsg":"成功",
"hzqrxxList": {
"頁Number":1,
"頁Size":20,
"total":1,
"list": [
"uuid":"红字确认单UUID",
"hzfpxxqrdbh":"红字发票信息确认单编号",
"Irfsf":"录入方身份",
```

"xsfnsrsbh": "(销售方) 统一社会信用代码/纳税人识别号/身份证件号码",

"xsfmc": " (销售方) 名称",

"gmfnsrsbh": " (购买方) 统一社会信用代码/纳税人识别号/身份证件号码",

"gmfmc": " (购买方) 名称",

"lzfpdm": "蓝字发票发票代码",

"lzfphm": "蓝字发票发票号码",

"sfzzfpbz": "是否纸质发票标志",

"lzkrq": "蓝字发票开票日期",

"lzhjje": "蓝字发票合计金额",

"Lzhjse": "蓝字发票合计税额",

"lzfppzDm": "蓝字发票发票票种代码",

"lzfpT Dysl x Dm": "蓝字发票特定要素类型代码",

"hzcxje": "红字冲销金额",

"hzcxse": "红字冲销税额",

"hzqrdmxsl": "红字确认单明细数量",

"chyyDm": "红字发票冲红原因代码",

"hzqrxztDm": "红字确认信息状态代码",

"qrrq": "确认日期",

"ykjhzfpbz": "已开具红字发票标志",

"hzfphm": "红字发票号码",

"hzkprq": "红字开票日期",

"yxbz": "有效标志",

"Irrq": "录入日期"

失败时返回：

```json
{
    "Response": {
        "RequestId": "16位随机数字和字母组合",
        "Error": {
            "Code": "01",
            "Message": "错误说明"
        }
    }
}
```

# 12.查询数电票上传结果

# 12.1接口说明

给企业提供查询数电票开具状态的功能，预发票上传后由税务局端对发票再次进行校验，如果校验通过则表明发票开具成功。此时企业根据上传返回的信息查询发票开具的状态。

发票上传结果只能在发票上传后12小时内查询，如果超过12小时只能重新上传发票再获取上传结果。

# 12.2请求参数

<table><tr><td>序号</td><td>数据项标识</td><td>数据项名称</td><td>字段类型</td><td>长度</td><td>必须</td><td>说明</td></tr><tr><td>1</td><td>sllsh</td><td>受理流水号</td><td>String</td><td>40</td><td>是</td><td></td></tr></table>

# 12.3请求报文示例

```json
{ "sllsh": "受理流水号" }
```

# 12.4返回参数

<table><tr><td>序号</td><td>数据项标识</td><td>数据项名称</td><td>字段类型</td><td>长度</td><td>必须</td><td>说明</td></tr><tr><td>1</td><td>returncode</td><td>返回码</td><td>varchar</td><td>2</td><td>是</td><td>00: 成功
其它: 失败</td></tr><tr><td>2</td><td>returnmsg</td><td>返回信息</td><td>varchar</td><td>2000</td><td>否</td><td>错误信息说明</td></tr><tr><td>3</td><td>fphm</td><td>发票号码</td><td>varchar</td><td>20</td><td>是</td><td></td></tr><tr><td>4</td><td>status</td><td>上传状态</td><td>varchar</td><td>2</td><td>是</td><td>00:上传成功
01:发票上传处理中
02:上传失败
03:重复上传</td></tr><tr><td>5</td><td>message</td><td>详细信息</td><td>varchar</td><td>30</td><td>否</td><td>详细信息</td></tr><tr><td>6</td><td>Code</td><td>错误码</td><td>varchar</td><td>20</td><td>否</td><td>未查询到上传结果会返回固定的Code值</td></tr></table>

# 12.5返回报文示例

成功返回：

```json
{
"Response": {
"RequestId":"16位随机数字和字母组合",
"Data": {
"returncode":"00",
"returnsmsg":"成功",
"resultList": [
"fphm":"发票号码1",
"status":"上传状态",
"message":"详细信息"
],
{
"fphm":"发票号码2",
"status":"上传状态",
"message":"详细信息"
}
]
```

```txt
} 1
```

失败返回：  
```json
{ "Response":{ "RequestId":"16位随机数字和字母组合", "Error":{ "Code":"01", "Message":"错误说明" } } }
```

# 13.数电红字确认单申请

# 13.1接口说明

给企业提供红字确认单开具功能

13.2请求参数  

<table><tr><td>序号</td><td>数据项标识</td><td>数据项名称</td><td>字段类型</td><td>长度</td><td>必须</td><td>说明</td></tr><tr><td>1</td><td>lrfsf</td><td>录入方身份</td><td>varchar</td><td>2</td><td>是</td><td>0:销方
1:购方</td></tr><tr><td>2</td><td>xsfnsrsbh</td><td>销售方纳税人识别号</td><td>varchar</td><td>20</td><td>是</td><td></td></tr><tr><td>3</td><td>xsfmc</td><td>销售方名称</td><td>varchar</td><td>300</td><td>是</td><td></td></tr><tr><td>4</td><td>gmfsrsbh</td><td>购买方纳税人识别号</td><td>varchar</td><td>20</td><td>否</td><td></td></tr><tr><td>5</td><td>gmfmc</td><td>购买方名称</td><td>varchar</td><td>300</td><td>是</td><td></td></tr><tr><td>6</td><td>lzfpdm</td><td>蓝字发票代码</td><td>varchar</td><td>12</td><td>否</td><td></td></tr><tr><td>7</td><td>lzfphm</td><td>蓝字发票号码</td><td>varchar</td><td>20</td><td>是</td><td></td></tr><tr><td>8</td><td>sfzzfpbz</td><td>是否纸质发票标志</td><td>varchar</td><td>1</td><td>是</td><td>Y:纸质发票</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td>N:电子发票</td></tr><tr><td>9</td><td>lzkrpq</td><td>蓝字发票开票日期</td><td>datetime</td><td></td><td>是</td><td>y y y y - M M - d dHH:mm:ss</td></tr><tr><td>10</td><td>lzhjie</td><td>蓝字发票合计金额</td><td>number</td><td>18,2</td><td>是</td><td></td></tr><tr><td>11</td><td>lzhjse</td><td>蓝字发票合计税额</td><td>number</td><td>18,2</td><td>是</td><td></td></tr><tr><td>12</td><td>lzfpppzDm</td><td>蓝字发票票种代码</td><td>varchar</td><td>2</td><td>是</td><td>01:增值税专用发票02:普通发票03:机动车统一销售发票04:二手车统一销售发票</td></tr><tr><td>13</td><td>lzfpTdyslxDm</td><td>蓝字发票特定要素类型代码</td><td>varchar</td><td>2</td><td>否</td><td>01:成品油发票02:稀土发票03:建筑服务发票04:货物运输服务发票05:不动产销售服务发票06:不动产租赁服务发票07:代收车船税08:通行费09:旅客运输服务发票10:医疗服务(住院)发票11:医疗服务(门诊)发票12:自产农产品销售发票13拖拉机和联合收割机发票14:机动车15:二手车16:农产品收购发票17:光伏收购发票18:卷烟发票20:农产品</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>14</td><td>hzcxje</td><td>红字冲销金额</td><td>number</td><td>18,2</td><td>是</td><td></td></tr><tr><td>15</td><td>hzcxse</td><td>红字冲销税额</td><td>number</td><td>18,2</td><td>是</td><td></td></tr><tr><td>16</td><td>chyyDm</td><td>红字发票冲红原因代码</td><td>varchar</td><td>2</td><td>是</td><td>01:开票有误
02:销货退回
03:服务中止
04:销售折让</td></tr><tr><td>17</td><td>lzmxxh</td><td>蓝字发票明细序号</td><td>number</td><td>8</td><td>是</td><td></td></tr><tr><td>18</td><td>xh</td><td>序号</td><td>number</td><td>8</td><td>是</td><td></td></tr><tr><td>19</td><td>sphfwssflhbbm</td><td>商品和服务税收分类
合并编码</td><td>String</td><td>19</td><td>是</td><td></td></tr><tr><td>20</td><td>hwhyslwfwmc</td><td>货物或应税劳务、服
务名称</td><td>varchar</td><td>300</td><td>是</td><td></td></tr><tr><td>21</td><td>spfwjc</td><td>商品服务简称</td><td>String</td><td>120</td><td>是</td><td></td></tr><tr><td>22</td><td>xmmc</td><td>项目名称</td><td>varchar</td><td>600</td><td>是</td><td></td></tr><tr><td>23</td><td>ggxh</td><td>规格型号</td><td>varchar</td><td>150</td><td>否</td><td></td></tr><tr><td>24</td><td>dw</td><td>单位</td><td>varchar</td><td>300</td><td>否</td><td>必须与蓝票“单
位”保持一致。</td></tr><tr><td>25</td><td>fpspdj</td><td>单价</td><td>varchar</td><td>25</td><td>否</td><td>如“数量”栏次
非空，则本栏次
必须非空</td></tr><tr><td>26</td><td>fpspsl</td><td>数量</td><td>varchar</td><td>25</td><td>否</td><td>如“单价”栏次
非空，则本栏次
必须非空</td></tr><tr><td>27</td><td>je</td><td>金额</td><td>number</td><td>18,2</td><td>是</td><td></td></tr><tr><td>28</td><td>sl1</td><td>税率</td><td>number</td><td>16,6</td><td>是</td><td></td></tr><tr><td>29</td><td>se</td><td>税额</td><td>number</td><td>18,2</td><td>是</td><td></td></tr></table>

# 13.3请求报文示例

```json
{"lrfsf": "录入方身份",  
"xsfnsrsbh": "销售方纳税人识别号",  
"xsfmc": "销售方名称",  
"gmfnsrsbh": "购买方纳税人识别号",  
"gmfmc": "购买方名称",
```

"zfpdm": "蓝字发票代码",

"lzfphm": "蓝字发票号码",

"sfzzfpbz": "是否纸质发票标志",

"lzkrq": "蓝字发票开票日期",

"lzhjje": "蓝字发票合计金额",

"Lzhjse": "蓝字发票合计税额",

"lzfppzDm": "蓝字发票票种代码",

"lzfpTdyslxDm": "蓝字发票特定要素类型代码",

"hzcxje": "红字冲销金额",

"hzcxse": "红字冲销税额",

"chyyDm": "红字发票冲红原因代码",

"hzqrdmxList": [

1

"lzmxxh": "蓝字发票明细序号",

"xh": "序号",

"sphfwssflhbbm": "商品和服务税收分类合并编码",

"hwhyslwfwmc": "货物或应税劳务、服务名称",

"spfwjc": "商品服务简称",

"xmmc": "项目名称",

"ggxh": "规格型号",

"dw": "单位",

"fpspdj": "单价",

"fpsps1": "数量",

"je": "金额",

"sl1": "税率",

"se": "税额"

} 1

13.4返回参数  

<table><tr><td>序号</td><td>数据项标识</td><td>数据项名称</td><td>字段类型</td><td>长度</td><td>必须</td><td>说明</td></tr><tr><td>1</td><td>returncode</td><td>返回码</td><td>varchar</td><td>2</td><td>是</td><td>00:成功
其它:失败</td></tr><tr><td>2</td><td>returnmsg</td><td>返回信息</td><td>varchar</td><td>2000</td><td>否</td><td>错误信息说明</td></tr><tr><td>3</td><td>hzfpxxqrdbh</td><td>红字确认单编号</td><td>varchar</td><td>20</td><td>否</td><td></td></tr><tr><td>4</td><td>uuid</td><td>红字确认单UUID</td><td>varchar</td><td>32</td><td>否</td><td></td></tr><tr><td>5</td><td>hzqrxxztDm</td><td>红字确认单状态</td><td>varchar</td><td>2</td><td>否</td><td>01:无需确认
02:销方录入待购方确认
03:购方录入待销方确认
04:购销双方已确认
05:作废(销方录入购方否认)
06:作废(购方录入销方否认)
07:作废(超72小时未确认)
08:(发起方撤销)
09:作废(确认后撤销)
10作废(异常凭证)</td></tr></table>

# 13.5返回报文示例

成功时返回：

```json
{
"Response":{ "RequestId":"16位随机数字和字母组合",
"Data":{ "returncode":"00",
"returnsmsg":"成功",
"hzfpxxqrdbh":"红字确认单编号",
"uuid":"红字确认单UUID",
"zfpxxqrdbh":"红字确认单ID号",
"zfpxxqrdbh":"红字确认单ID号",
"zfpxxqrdbh":"红字确认单ID号",
"zfpxxqrdbh":"红字确认单ID号",
"zfpxxqrdbh":"红字确认单ID号",
"zfpxxqrdbh":"红字确认单ID号",
"zfpxxqrdbh":"红字确认单ID号",
"zfpxxqrdbh":"16位随机数字和字母组合",
"Data":{ "returncode":"00",
"returnsmsg":"成功",
"hzfpxxqrdbh":"红字确认单编号",
"uuid":"红字确认单UUID",
"zfpxxqrdbh":"红字确认单ID号",
"zfpxxqrdbh":"红字确认单ID号",
"zfpxxqrdbh":"红字确认单ID号",
"zfpxxqrdbh":"红字确认单ID号",
"zfpxxqrdbh":"红字确认单ID号",
"zwpxxqrdbh":"红字确认单编号",
"zwpxxqrdbh":"红字确认单ID号",
"zwpxxqrdbh":"红字确认单ID号",
"zwpxxqrdbh":"红字确认单ID号",
"zwpxxqrdbh":"红字确认单ID号",
"zwpxxqrdbh":"红字确认单ID号",
"zwpxxqrdbh":"红字确认单ID号",
"zwpxxqrdbh":"红字确认单ID号",
"zwpxxqrdbh":"16位随机数字和字母组合",
"Data":{ "returncode":"00",
"returnsmsg":"成功",
"hzfpxxqrdbh":"红字确认单编号",
"uuid":"红字确认单UUID",
"zwpxxqrdbh":"红字确认单ID号",
"zwpxxqrdbh":"红字确认单ID号",
"zwpxxqrdbh":"红字确认单ID号",
"zwpxxqrdbh":"红字确认单ID号",
"zwpxxqrdbh":"红字确认单ID号",
"zwpxxqrdbh":"红字确认单ID号",
"zwpxxqrdbh":"红色确认单编号",
"zwpxxqrdbh":"红色确认单编号",
"zwpxxqrdbh":"红色确认单ID号",
"zwpxxqrdbh":"红色确认单ID号",
"zwpxxqrdbh":"红色确认单ID号",
"zwpxxqrdbh":"红色确认单ID号",
"zwpxxqrdbh":"红色确认单ID号",
"zwpxxqrdbh":"红色确认单ID号",
"zwpxxqrdbh":"红色确认单ID号",
"zwpxxqrdbh":"红色确认单ID号",
'uluid': "uluid",
```

```txt
"hzqrxztDm":"红字确认单状态"   
}   
}   
}
```

失败返回：  
```json
{ "Response":{ "RequestId":"16位随机数字和字母组合", "Error":{ "Code":"01”， "Message":"错误说明" } } }
```

# 14.数电红字确认单确认

# 14.1接口说明

给企业提供数电红字确认单确认接口，将已经确认的红字确认单确认并上传成功后表明红字确认单确认成功。

14.2请求参数  

<table><tr><td>序号</td><td>数据项标识</td><td>数据项名称</td><td>字段类型</td><td>长度</td><td>必须</td><td>说明</td></tr><tr><td>1</td><td>xsfnsrsbh</td><td>统一社会信用代码/纳税人识别号/身份证号码</td><td>varchar</td><td>20</td><td>是</td><td></td></tr><tr><td>2</td><td>uuid</td><td>红字确认单UUID</td><td>varchar</td><td>32</td><td>是</td><td></td></tr><tr><td>3</td><td>hzqrdbh</td><td>红字确认单编号</td><td>varchar</td><td>20</td><td>是</td><td></td></tr><tr><td>4</td><td>qrlx</td><td>确认类型</td><td>varchar</td><td>1</td><td>是</td><td>Y:同意N:不同意C:撤销</td></tr></table>

# 14.3请求报文示例

```json
{
"xsfnsrsbh":"（销售方）统一社会信用代码/纳税人识别号/身份证件号码",
"uuid":"红字确认单UUID",
"hzqrdbh":"红字确认单编号",
"qrlx":"确认类型"
}
```

# 14.4返回参数

<table><tr><td>序号</td><td>数据项标识</td><td>数据项名称</td><td>字段类型</td><td>长度</td><td>必须</td><td>说明</td></tr><tr><td>1</td><td>returncode</td><td>返回码</td><td>varchar</td><td>2</td><td>是</td><td>00: 成功
其它: 失败</td></tr><tr><td>2</td><td>returnmsg</td><td>返回信息</td><td>varchar</td><td>2000</td><td>否</td><td>错误信息说明</td></tr><tr><td>3</td><td>qrrq</td><td>确认日期</td><td>datetime</td><td></td><td>否</td><td>格式:
yyyy-MM-dd
HH:mm:ss</td></tr></table>

# 14.5返回报文示例

成功时返回：

```json
{ "Response":{ "RequestId":"16位随机数字和字母组合", "Data": { "returncode":"00", "returnmsg":"成功", "qrrq":"确认日期" } } } }
```

失败返回：

```txt
1
```

```json
"Response":{ "RequestId":"16位随机数字和字母组合", "Error":{ "Code":"01”， "Message":"错误说明" } } } }
```

# 15.上传发票汇总确认信息

# 15.1接口说明

给企业提供按月上传发票汇总信息接口，以避免由于企业未及时上传发票而带来的问题。企业在每月13日前需按自然月汇总上月在本平台开具的数电票的数量、金额和税额进行上传至乐企服务端，与乐企服务端汇总接收到的数电票信息进行比对，若比对一致，返回比对成功；若比对不一致，返回具体失败信息，由企业核实后，再次上传。

若企业在每月13日前未上传上个月的发票汇总确认信息，乐企服务端将在13日零点汇总乐企服务端接收到的上个月的数子化电子发票。

当企业上传发票汇总确认信息后，发现已确认的月份还有数电票未上传，可以取消发票汇总确认，把未上传的数电票上传至乐企服务端后再次上传发票汇总确认信息。

15.2请求参数  

<table><tr><td>序号</td><td>数据项标识</td><td>数据项名称</td><td>字段类型</td><td>长度</td><td>必须</td><td>说明</td></tr><tr><td>1</td><td>xsfnsrsbh</td><td>销售方纳税人识别号</td><td>varchar</td><td>20</td><td>是</td><td></td></tr><tr><td>2</td><td>xsfsjswgdm</td><td>销售方省级税务机关代码</td><td>varchar</td><td>11</td><td>是</td><td></td></tr><tr><td>3</td><td>ywlx</td><td>业务类型</td><td>varchar</td><td>1</td><td>是</td><td>0:确认
1:取消</td></tr><tr><td>4</td><td>ptbh</td><td>平台编号</td><td>varchar</td><td>20</td><td>是</td><td></td></tr><tr><td>5</td><td>yf</td><td>月份</td><td>varchar</td><td>7</td><td>是</td><td>格式: yyyy-MM</td></tr><tr><td>6</td><td>lzfpssl</td><td>蓝字发票数量</td><td>number</td><td>10</td><td>否</td><td>业务类型为“0”时必填</td></tr><tr><td>7</td><td>lzfpje</td><td>蓝字发票金额</td><td>number</td><td>18,2</td><td>否</td><td>业务类型为“0”时必填</td></tr><tr><td>8</td><td>lzfpse</td><td>蓝字发票税额</td><td>number</td><td>18,2</td><td>否</td><td>业务类型为“0”时必填</td></tr><tr><td>9</td><td>hzfpsl</td><td>红字发票数量</td><td>number</td><td>10</td><td>否</td><td>业务类型为</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td>“0”时必填</td></tr><tr><td>10</td><td>hzfpje</td><td>红字发票金额</td><td>number</td><td>18,2</td><td>否</td><td>业务类型为
“0”时必填</td></tr><tr><td>11</td><td>hzfpse</td><td>红字发票税额</td><td>number</td><td>18,2</td><td>否</td><td>业务类型为
“0”时必填</td></tr></table>

# 15.3请求报文示例

```jsonl
{"xsfnsrsbh":"销售方纳税人识别号", "xsfsjswjgdm":"销售方省级税务机关代码", "ywlx":"业务类型", "ptbh":"平台编号", "yf":"月份", "lzfpsl":"蓝字发票数量", "lzfpje":"蓝字发票金额", "lzfpse":"蓝字发票税额", "hzfpsl":"红字发票数量", "hzfpje":"红字发票金额", "hzfpse":"红字发票税额" }
```

# 15.4返回参数

<table><tr><td>序号</td><td>数据项标识</td><td>数据项名称</td><td>字段类型</td><td>长度</td><td>必须</td><td>说明</td></tr><tr><td>1</td><td>returncode</td><td>返回码</td><td>varchar</td><td>2</td><td>是</td><td>00: 成功
其它: 失败</td></tr><tr><td>2</td><td>returnmsg</td><td>返回信息</td><td>varchar</td><td>2000</td><td>否</td><td>错误信息说明</td></tr></table>

# 15.5返回报文示例

成功时返回：

```txt
{
```

```json
"Response":{ "RequestId":"16位随机数字和字母组合", "Data": { "returncode":"00", "returnmsg":"成功" } } } }
```

失败返回：  
```json
{ "Response":{ "RequestId":"16位随机数字和字母组合", "Error":{ "Code":"01”， "Message":"错误说明" } } 1
```

# 16. 查询发票汇总确认信息

# 16.1接口说明

给企业提供发票汇总确认信息查询功能，企业可以通过此接口查询历史发票汇总确认信息。

# 16.2请求参数

<table><tr><td>序号</td><td>数据项标识</td><td>数据项名称</td><td>字段类型</td><td>长度</td><td>必须</td><td>说明</td></tr><tr><td>1</td><td>xsfnsrsbh</td><td>销售方纳税人识别号</td><td>varchar</td><td>20</td><td>是</td><td></td></tr><tr><td>2</td><td>xsfsjswgdm</td><td>销售方省级税务机关代码</td><td>varchar</td><td>11</td><td>是</td><td></td></tr><tr><td>3</td><td>ptbh</td><td>平台编号</td><td>varchar</td><td>20</td><td>否</td><td>若为空,则查询纳税人在所有平</td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td>台的开票汇总信息</td></tr><tr><td>4</td><td>yf</td><td>月份</td><td>varchar</td><td>7</td><td>否</td><td>格式：yyyyMMdd-MM若为空，则查询所有历史月份数据</td></tr></table>

# 16.3请求报文示例

```jsonl
{"xsfnsrsbh":"销售方纳税人识别号", "xsfsjswjgdm":"销售方省级税务机关代码", "ptbh":"平台编号", "yf":"月份" }
```

# 16.4返回参数

<table><tr><td>序号</td><td>数据项标识</td><td>数据项名称</td><td>字段类型</td><td>长度</td><td>必须</td><td>说明</td></tr><tr><td>1</td><td>returncode</td><td>返回码</td><td>varchar</td><td>2</td><td>是</td><td>00:成功
其它:失败</td></tr><tr><td>2</td><td>returnmsg</td><td>返回信息</td><td>varchar</td><td>2000</td><td>否</td><td>错误信息说明</td></tr><tr><td>3</td><td>xsfnsrsbh</td><td>销售方纳税人识别号</td><td>varchar</td><td>20</td><td>是</td><td></td></tr><tr><td colspan="7">发票汇总确认信息(多条记录时,循环以下节点)</td></tr><tr><td>4</td><td>ptbh</td><td>平台编号</td><td>varchar</td><td>20</td><td>否</td><td></td></tr><tr><td>5</td><td>yf</td><td>月份</td><td>varchar</td><td>7</td><td>否</td><td>格式: yyyy-MM</td></tr><tr><td>6</td><td>lzfpsl</td><td>蓝字发票数量</td><td>number</td><td>10</td><td>否</td><td></td></tr><tr><td>7</td><td>lzfpje</td><td>蓝字发票金额</td><td>number</td><td>18,2</td><td>否</td><td></td></tr><tr><td>8</td><td>lzfpse</td><td>蓝字发票税额</td><td>number</td><td>18,2</td><td>否</td><td></td></tr><tr><td>9</td><td>hzfpsl</td><td>红字发票数量</td><td>number</td><td>10</td><td>否</td><td></td></tr><tr><td>10</td><td>hzfpje</td><td>红字发票金额</td><td>number</td><td>18,2</td><td>否</td><td></td></tr><tr><td>11</td><td>hzfpsse</td><td>红字发票税额</td><td>number</td><td>18,2</td><td>否</td><td></td></tr></table>

# 16.5返回报文示例

成功时返回：

```json
{ "Response": { "RequestId":"16位随机数字和字母组合", "Data": { "returncode":"00", "returnsmsg":"成功", "xsfnsrsbh":"销售方纳税人识别号", "fphzqrxxList": [ {"ptbh":"平台编号", "yf":"月份", "lzfpsl":"蓝字发票数量", "lzfpje":"蓝字发票金额", "lzfpse":"蓝字发票税额", "hzfpsl":"红字发票数量", "hzfpje":"红字发票金额", "hzfpse":"红字发票税额" }, {"ptbh":"平台编号", "yf":"月份", "lzfpsl":"蓝字发票数量", "lzfpje":"蓝字发票金额", "lzfpse":"蓝字发票税额", "hzfpsl":"红字发票数量", "hzfpje":"红字发票金额", "hzfpse":"红字发票税额" } ] } } }
```

失败返回：

```json
{ "Response":{ "RequestId":"16位随机数字和字母组合", "Error":{ "Code":"01"， "Message":"错误说明" } } }
```

# 17. 查询差额征税编码

# 17.1接口说明

向企业提供查询差额征税编码信息的功能，企业可将查询的差额征税编码信息保存在本地。在开具差额征税发票时选择保存在本地的差额征税编码。

# 17.2请求参数

无

# 17.3请求报文示例

{}

# 17.4返回参数

<table><tr><td>序号</td><td>数据项标识</td><td>数据项名称</td><td>字段类型</td><td>长度</td><td>必须</td><td>说明</td></tr><tr><td>1</td><td>returncode</td><td>返回码</td><td>varchar</td><td>2</td><td>是</td><td>00: 成功
其它: 失败</td></tr><tr><td>2</td><td>returnmsg</td><td>返回信息</td><td>varchar</td><td>2000</td><td>否</td><td>错误信息说明</td></tr><tr><td>3</td><td>count</td><td>总数量</td><td>number</td><td>10</td><td>是</td><td></td></tr><tr><td>4</td><td>sphfwssflhbbm</td><td>商品和服务税收分类合并编码</td><td>varchar</td><td>19</td><td>是</td><td></td></tr><tr><td>5</td><td>sphfwmc</td><td>商品和服务名称</td><td>varchar</td><td>150</td><td>是</td><td></td></tr><tr><td>6</td><td>sphfwfljc</td><td>商品和服务分类简称</td><td>varchar</td><td>120</td><td>是</td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>7</td><td>sfkycekp</td><td>是否可以差额开票</td><td>varchar</td><td>1</td><td>是</td><td>Y: 是
N: 否</td></tr><tr><td>8</td><td>cekpsfkykzp</td><td>差额开票是否可以开专票</td><td>varchar</td><td>1</td><td>是</td><td>Y: 是
N: 否</td></tr><tr><td>9</td><td>qekpsfkykzp</td><td>全额开票是否可以开专票</td><td>varchar</td><td>1</td><td>是</td><td>Y: 是
N: 否</td></tr><tr><td>10</td><td>ybnsrsl</td><td>一般纳税人税率</td><td>varchar</td><td>50</td><td>否</td><td>取值返回是中文
顿号连接的百分
数。例如3%、
5%</td></tr><tr><td>11</td><td>ybnsrzsl</td><td>一般纳税人征收率</td><td>varchar</td><td>50</td><td>否</td><td></td></tr><tr><td>12</td><td>xgmnsrzsl</td><td>小规模纳税人征收率</td><td>varchar</td><td>50</td><td>否</td><td></td></tr></table>

# 17.5返回报文示例

成功返回：

```json
{ "Response":{ "RequestId":"16位随机数字和字母组合", "Data":{ "returncode":"00", "returnsmsg":"成功", "count":"总数量", "cezsbmList":[ { "sphfwssflhbbm":"商品和服务税收分类合并编码", "sphfwmc":"商品和服务名称", "sphfwflic":"商品和服务分类简称", "sfkycekp":"是否可以差额开票", "cekpsfkykzp":"差额开票是否可以开专票", "qekpsfkykzp":"全额开票是否可以开专票", "ybnsrsl":"一般纳税人税率", "ybnsrzsl":"一般纳税人征收率",
```

"xgmnsrzsl": "小规模纳税人征收率"

失败返回：  
```txt
1 1
```

```json
{
"Response":{ "RequestId":"16位随机数字和字母组合", "Error":{ "Code":"01"， "Message":"错误说明"
}
```